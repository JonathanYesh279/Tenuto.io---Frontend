---
phase: 06-foundation
plan: 02
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - src/styles/tab-navigation-fix.css
  - src/styles/teacher-modal-fixes.css
  - src/components/ui/select.tsx
  - src/index.css
autonomous: true

must_haves:
  truths:
    - "Color !important overrides on body/html elements and non-option selectors are eliminated from tab-navigation-fix.css and teacher-modal-fixes.css. Native <option> !important may remain with TODO comment for Phase 7 replacement with shadcn Select. Responsive display toggles may retain !important with TODO comments for Phase 7 tab migration."
    - "shadcn Select component uses logical CSS properties (ps-, pe-, start, end) instead of physical (pl-, pr-, left, right) for correct RTL rendering, and teacher-modal-fixes.css uses padding-inline-start/end instead of padding-left/right with no physical [dir='rtl'] override block"
    - "Dead CSS files (globals.css, fonts.css) are deleted and not referenced anywhere"
    - "Animations follow the purposeful-and-limited philosophy: only modals, toasts, and tabs have transitions — no decorative motion"
    - "npm run build passes with zero errors after all CSS changes"
  artifacts:
    - path: "src/styles/tab-navigation-fix.css"
      provides: "Tab navigation styles without !important overrides"
    - path: "src/styles/teacher-modal-fixes.css"
      provides: "Teacher modal styles without !important overrides, logical CSS properties, no decorative motion"
    - path: "src/components/ui/select.tsx"
      provides: "RTL-correct Select with logical properties"
      contains: "ps-8"
  key_links:
    - from: "src/index.css"
      to: "src/styles/tab-navigation-fix.css"
      via: "@import ./styles/tab-navigation-fix.css"
      pattern: "@import.*tab-navigation"
    - from: "src/index.css"
      to: "src/styles/teacher-modal-fixes.css"
      via: "@import ./styles/teacher-modal-fixes.css"
      pattern: "@import.*teacher-modal"
---

<objective>
Clean CSS overrides, fix RTL physical properties in shadcn components, and remove dead files — completing the foundation phase with a clean, standards-compliant CSS layer.

Purpose: The `!important` overrides in custom CSS files defeat the design token system installed in Plan 06-01. Physical CSS properties (pl-, pr-, left, right) in shadcn components render incorrectly in RTL. Dead CSS files (globals.css, fonts.css) add confusion. This plan removes all three problems.

Output: Clean CSS files without !important hacks, RTL-correct shadcn Select component, no dead CSS files.
</objective>

<execution_context>
@/home/yona279/.claude/get-shit-done/workflows/execute-plan.md
@/home/yona279/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-foundation/06-RESEARCH.md
@.planning/phases/06-foundation/06-01-SUMMARY.md

Key source files:
@src/styles/tab-navigation-fix.css
@src/styles/teacher-modal-fixes.css
@src/components/ui/select.tsx
@src/index.css
@src/styles/globals.css (dead file — to be deleted)
@src/styles/fonts.css (dead file — to be deleted)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove !important overrides and fix RTL physical properties in shadcn components</name>
  <files>
    src/styles/tab-navigation-fix.css
    src/styles/teacher-modal-fixes.css
    src/components/ui/select.tsx
  </files>
  <action>
**Step 1: Fix tab-navigation-fix.css !important overrides**

This file has the following !important usages that need fixing:

1. **Lines 7, 13, 17: `background: white !important`** on `.student-details-container`, `body`, and `html`:
   - REMOVE the `body { background: white !important; }` rule entirely (line 12-14). The body background is already set in `index.css` and now backed by the `--background` token.
   - REMOVE the `html { background: white !important; }` rule entirely (line 16-18). Same reason.
   - For `.student-details-container`: change `background: white !important;` to `background-color: hsl(var(--background));` (no !important — the class specificity is sufficient for a container class).

2. **Lines 128, 132, 143, 147: responsive display overrides**:
   ```css
   @media (max-width: 768px) {
     .desktop-tab-nav { display: none !important; }
     .mobile-tab-nav { display: block !important; }
   }
   @media (min-width: 769px) {
     .desktop-tab-nav { display: flex !important; }
     .mobile-tab-nav { display: none !important; }
   }
   ```
   These responsive show/hide rules use `!important` to override inline styles or Tailwind classes. The fix:
   - Check if `.desktop-tab-nav` and `.mobile-tab-nav` have inline `style` attributes or competing Tailwind display classes in the component JSX. If so, the `!important` may be genuinely needed to override inline styles.
   - **Safe approach for Phase 6 (zero regression):** Replace `!important` with a double-class specificity selector. For example:
     ```css
     @media (max-width: 768px) {
       .student-tab-navigation .desktop-tab-nav { display: none; }
       .student-tab-navigation .mobile-tab-nav { display: block; }
     }
     @media (min-width: 769px) {
       .student-tab-navigation .desktop-tab-nav { display: flex; }
       .student-tab-navigation .mobile-tab-nav { display: none; }
     }
     ```
   - If the parent `.student-tab-navigation` does not exist in the DOM at that point, use `body .desktop-tab-nav` instead for higher specificity. Test the build — if specificity alone does not work, keep these 4 as `!important` and add a `/* TODO(Phase 7): remove !important after tab migration to shadcn Tabs */` comment. The responsive display toggle is the LEAST harmful !important use and can wait for the tab component migration.

**Step 2: Fix teacher-modal-fixes.css !important overrides**

Lines 5-22 have color/background `!important` on `.teacher-student-select` and its options:
```css
.teacher-student-select { color: #111827 !important; background-color: #ffffff !important; }
.teacher-student-select option { color: #111827 !important; background-color: #ffffff !important; }
.teacher-student-select option:hover { background-color: #f3f4f6 !important; color: #111827 !important; }
.teacher-student-select option:checked { background-color: #3b82f6 !important; color: #ffffff !important; }
```

These override native `<select>` option styling which is notoriously hard to control. Fix:
- Replace with higher-specificity selectors and `color-scheme: light;`:
  ```css
  .teacher-student-select {
    color: hsl(var(--foreground));
    background-color: hsl(var(--background));
    color-scheme: light;
  }

  .teacher-student-select option {
    color: hsl(var(--foreground));
    background-color: hsl(var(--card));
    padding: 8px 12px;
  }

  .teacher-student-select option:hover {
    background-color: hsl(var(--muted));
    color: hsl(var(--foreground));
  }

  .teacher-student-select option:checked {
    background-color: hsl(var(--primary));
    color: hsl(var(--primary-foreground));
  }
  ```
- The `color-scheme: light` property tells the browser to render form controls with light theme — this eliminates the root cause (dark mode browser settings making options invisible) without needing `!important`.
- HOWEVER: native `<option>` elements notoriously ignore CSS in many browsers. If `color-scheme: light` does not work, the `!important` on `.teacher-student-select option` may need to stay with a `/* TODO(Phase 7): replace native select with shadcn Select */` comment. Phase 7 will replace these with Radix Select, making the CSS moot.

**Step 3: Fix RTL physical properties in teacher-modal-fixes.css**

teacher-modal-fixes.css (lines 54-68) has physical `padding-left`, `padding-right`, and `background-position left/right` properties that are RTL-incorrect per FNDTN-05:

1. **Lines 58-61:** The base `.teacher-student-select` has `background-position: left 12px center;` and `padding-left: 40px;`. Change to logical properties:
   ```css
   .teacher-student-select {
     appearance: none;
     background-image: url("data:image/svg+xml;charset=UTF-8,...");
     background-repeat: no-repeat;
     background-position: inline-start 12px center;
     background-size: 16px;
     padding-inline-start: 40px;
   }
   ```
   NOTE: `background-position` does NOT support logical keywords (`inline-start`) in all browsers yet. The safe RTL approach is to use the existing `[dir="rtl"]` override block BUT convert IT to logical properties too. Since the `[dir="rtl"]` block already handles the flip, the simplest correct fix is:
   - Base `.teacher-student-select`: keep `background-position: left 12px center;` and change `padding-left: 40px;` to `padding-inline-start: 40px;`
   - `[dir="rtl"] .teacher-student-select` block (lines 64-68): change `background-position: right 12px center;` (keep — physical is fine inside a dir selector), change `padding-left: 12px; padding-right: 40px;` to `padding-inline-start: 40px; padding-inline-end: 12px;`

   Actually, the cleanest fix: since the app is ALWAYS RTL (`dir="rtl"` on html), merge the `[dir="rtl"]` block into the base selector and delete the separate `[dir="rtl"]` block:
   ```css
   .teacher-student-select {
     appearance: none;
     background-image: url("data:image/svg+xml;...");
     background-repeat: no-repeat;
     background-position: right 12px center;
     background-size: 16px;
     padding-inline-start: 40px;
     padding-inline-end: 12px;
   }
   ```
   Delete the entire `[dir="rtl"] .teacher-student-select { ... }` block (lines 64-68).

2. **Line 99:** `.teacher-search-option:hover { transform: translateX(-2px); }` — this is a decorative hover animation AND RTL-incorrect (moves left in LTR, which would be the wrong direction in RTL). Remove the entire `transform: translateX(-2px);` declaration. Per user decision: "NO decorative motion on cards, list items, or hover effects beyond color shifts."

3. **Line 103:** `.teacher-search-option.highlighted { box-shadow: inset 3px 0 0 #3b82f6; }` — this `inset 3px 0 0` creates a left-edge highlight bar, but in RTL the highlight should be on the right (inline-start) edge. Change to `box-shadow: inset -3px 0 0 hsl(var(--primary));` to place it on the right edge in the default layout direction. Also replaces hardcoded blue hex with design token.

**Step 4: Fix RTL physical properties in src/components/ui/select.tsx**

The shadcn Select component uses physical CSS properties that break in RTL:

1. `SelectLabel` (line ~106): `pl-8 pr-2` → change to `ps-8 pe-2` (logical start/end padding)
2. `SelectItem` (line ~119): `pl-8 pr-2` → change to `ps-8 pe-2`
3. `SelectItem` indicator span (line ~124): `left-2` → change to `start-2` (logical start position)

The `ps-` (padding-start) and `pe-` (padding-end) and `start-` utilities use CSS logical properties which automatically flip in RTL. Tailwind v3 supports these out of the box.

Specific changes:
- `SelectLabel`: `"py-1.5 pl-8 pr-2 text-sm font-semibold"` → `"py-1.5 ps-8 pe-2 text-sm font-semibold"`
- `SelectItem`: `"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm ..."` → `"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 ps-8 pe-2 text-sm ..."`
- Indicator span: `"absolute left-2 flex h-3.5 w-3.5 items-center justify-center"` → `"absolute start-2 flex h-3.5 w-3.5 items-center justify-center"`
  </action>
  <verify>
1. `grep -c '!important' src/styles/tab-navigation-fix.css` — should be 0, or at most 4 (responsive display toggles if specificity approach didn't work)
2. `grep -c '!important' src/styles/teacher-modal-fixes.css` — should be 0, or at most 4 (native option styling if color-scheme approach didn't work)
3. `grep 'padding-left\|padding-right' src/styles/teacher-modal-fixes.css` — should return NO matches (all replaced with padding-inline-start/end)
4. `grep 'translateX' src/styles/teacher-modal-fixes.css` — should return NO matches (decorative hover removed)
5. `grep '\[dir="rtl"\]' src/styles/teacher-modal-fixes.css` — should return NO matches (merged into base selector)
6. `grep 'pl-8\|pr-2\|left-2' src/components/ui/select.tsx` — should return NO matches (all replaced with logical properties)
7. `grep 'ps-8\|pe-2\|start-2' src/components/ui/select.tsx` — should return matches confirming logical properties are in place
8. `npm run build` succeeds
  </verify>
  <done>
!important overrides removed from tab-navigation-fix.css (body/html/container backgrounds) and teacher-modal-fixes.css (select option colors). Physical RTL properties in teacher-modal-fixes.css (padding-left/right, [dir="rtl"] override block) replaced with logical properties (padding-inline-start/end) and merged into base selector. Decorative translateX(-2px) hover removed. Highlighted option box-shadow flipped for RTL. shadcn Select component uses logical properties (ps-, pe-, start-) instead of physical (pl-, pr-, left-). Build passes. Any stubborn !important left has a TODO comment for Phase 7 migration.
  </done>
</task>

<task type="auto">
  <name>Task 2: Delete dead CSS files and reconcile animation definitions</name>
  <files>
    src/styles/globals.css
    src/styles/fonts.css
    src/index.css
  </files>
  <action>
**Step 1: Verify globals.css and fonts.css are truly dead**

Before deleting, confirm no imports exist:
- `grep -rn "globals.css" src/` should return nothing
- `grep -rn "fonts.css" src/` should return nothing
- Neither file is imported in `index.css` (the only CSS entry point)

If any imports are found, do NOT delete — instead note them for investigation.

**Step 2: Delete dead CSS files**

If confirmed dead:
- Delete `src/styles/globals.css`
- Delete `src/styles/fonts.css`

These files contain duplicate Tailwind base imports and unused font declarations that would confuse future developers.

**Step 3: Move useful patterns from globals.css to index.css**

Before deleting globals.css, extract the following useful patterns and add them to `src/index.css` if they don't already exist there:

1. **Reduced motion media query** (globals.css lines 121-130) — this is a legitimate accessibility pattern:
   ```css
   @media (prefers-reduced-motion: reduce) {
     *,
     *::before,
     *::after {
       animation-duration: 0.01ms !important;
       animation-iteration-count: 1 !important;
       transition-duration: 0.01ms !important;
       scroll-behavior: auto !important;
     }
   }
   ```
   These `!important` are LEGITIMATE — they are the standard WAI-ARIA pattern for reduced motion accessibility (A11Y-04 requirement). Add this block to the END of `src/index.css` if not already present.

2. **Print styles** (globals.css lines 105-118) — useful:
   ```css
   @media print {
     .no-print {
       display: none !important;
     }
   }
   ```
   This `!important` is LEGITIMATE for print media. Add to `src/index.css` if not already present.

Do NOT migrate: the dark mode block, the `::selection` block (uses `@apply bg-primary-100 text-primary-900` which will break when primary scale changes), error/success/warning state classes (they reference `danger-*` colors that don't exist in the Tailwind config), or the duplicate Tailwind base imports.

**Step 4: Reconcile animation definitions**

Per user decision: animations should be "subtle and purposeful — ONLY modals, toasts, tabs, and page transitions. Everything else is instant." Speed: 100-200ms. Easing: ease-out.

Review the animation definitions in `tailwind.config.js` (already modified in Plan 06-01) and `src/index.css`:

In `tailwind.config.js`, the existing animations are:
- `fade-in: fadeIn 0.5s ease-in-out` — too slow (500ms). Change to `0.15s ease-out` (for page transitions per user decision)
- `slide-up: slideUp 0.3s ease-out` — acceptable (for toasts). Keep but reduce to `0.2s ease-out`
- `slide-down: slideDown 0.3s ease-out` — same. Reduce to `0.2s ease-out`
- `scale-in: scaleIn 0.2s ease-out` — good (for modals). Keep as-is
- `pulse-soft: pulseSoft 2s ease-in-out infinite` — this is a DECORATIVE animation (infinite loop). Remove it entirely per user decision "no decorative motion."

In `src/index.css`, the existing animations are:
- `.animate-slide-down` (keyframe slide-down, 0.3s) — reduce to 0.2s ease-out
- `.animate-fade-in` (keyframe fade-in, 0.2s) — good, keep
- `.animate-zoom-in` (keyframe zoom-in, 0.2s) — good, keep (for modals)

Before removing `pulse-soft`, verify it's not used in critical UI:
- `grep -rn "pulse-soft\|pulseSoft\|animate-pulse-soft" src/` — if used, keep but add comment about future removal. If unused, remove from tailwind.config.js.

Summary of animation changes:
- `fade-in`: 0.5s → 0.15s, `ease-in-out` → `ease-out`
- `slide-up`: 0.3s → 0.2s
- `slide-down`: 0.3s → 0.2s
- `pulse-soft`: remove if unused, keep with comment if used
- CSS `.animate-slide-down`: 0.3s → 0.2s, `ease-out` (already)
  </action>
  <verify>
1. `ls src/styles/globals.css 2>/dev/null` — should not exist (file deleted)
2. `ls src/styles/fonts.css 2>/dev/null` — should not exist (file deleted)
3. `grep -rn "globals.css\|fonts.css" src/` — should return nothing (no references)
4. `grep "prefers-reduced-motion" src/index.css` — should confirm reduced-motion block was migrated
5. `grep "0.5s" tailwind.config.js` — should NOT match (fade-in was 0.5s, now 0.15s)
6. `npm run build` succeeds
  </verify>
  <done>
Dead CSS files (globals.css, fonts.css) deleted. Useful accessibility patterns (reduced-motion, print) migrated to index.css. Animation durations aligned to 100-200ms ease-out per user decision. Decorative pulse-soft animation removed (or commented for removal). Build passes.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` passes — zero errors after all CSS changes
2. `grep -rn '!important' src/styles/tab-navigation-fix.css src/styles/teacher-modal-fixes.css | wc -l` — should be 0 (or minimal with TODO comments)
3. `grep -c 'ps-8\|pe-2\|start-2' src/components/ui/select.tsx` — logical properties present
4. `ls src/styles/globals.css src/styles/fonts.css 2>/dev/null` — neither exists
5. `grep 'prefers-reduced-motion' src/index.css` — accessibility pattern present
6. No animation exceeds 200ms except reduced-motion override
</verification>

<success_criteria>
- Color !important overrides on body/html and non-option selectors eliminated in tab-navigation-fix.css and teacher-modal-fixes.css (native option !important and responsive display toggles may retain with TODO for Phase 7)
- shadcn Select uses logical CSS properties (ps-, pe-, start-) for RTL correctness
- teacher-modal-fixes.css uses logical properties (padding-inline-start/end), no [dir="rtl"] override block, no decorative translateX motion
- globals.css and fonts.css are deleted
- Useful patterns (reduced-motion, print) migrated to index.css
- Animations are 100-200ms with ease-out easing; no decorative infinite animations remain
- npm run build passes
</success_criteria>

<output>
After completion, create `.planning/phases/06-foundation/06-02-SUMMARY.md`
</output>
