---
phase: 18-typography-scale-and-color-evolution
plan: 03
type: execute
wave: 2
depends_on: ["18-01"]
files_modified:
  - src/components/Layout.tsx
  - src/components/Header.tsx
  - src/components/ui/StatsCard.tsx
autonomous: true

must_haves:
  truths:
    - "Content area background is a cool light gray — not the warm coral-tinted off-white from v2.0"
    - "Header has clear visual separation from the content area on a white/light background"
    - "StatsCard accepts entity color names (students, teachers, orchestras, etc.) as color prop values"
    - "StatsCard renders entity-colored icon backgrounds and value text using the CSS var token system"
    - "Layout shell has distinct visual zones — sidebar, header, and content are clearly separated"
  artifacts:
    - path: "src/components/Layout.tsx"
      provides: "Updated content area with cool light background"
      contains: "bg-background"
    - path: "src/components/Header.tsx"
      provides: "Header with clear border visibility on light backgrounds"
      contains: "border-b"
    - path: "src/components/ui/StatsCard.tsx"
      provides: "Entity color system for stat cards"
      contains: "students"
  key_links:
    - from: "src/components/ui/StatsCard.tsx"
      to: "src/index.css"
      via: "Tailwind utilities consuming entity color CSS vars"
      pattern: "students-bg|teachers-fg"
    - from: "src/components/Layout.tsx"
      to: "src/index.css"
      via: "bg-background consuming updated --background var"
      pattern: "bg-background"
---

<objective>
Update the layout shell (Layout.tsx, Header.tsx) for the new light visual foundation and transform StatsCard.tsx to use the entity color token system.

Purpose: The layout shell changes ensure the content area, header, and overall page feel align with the new light/pastel identity. The StatsCard entity color update gives every stat card a distinct pastel identity per entity type — this is the first consumer of the entity color tokens defined in 18-01, and it will be used by Dashboard (Phase 19) and list page hero zones (Phase 20).

Output: Updated Layout.tsx, Header.tsx, and StatsCard.tsx — the structural shell supports the new visual identity and the primary data visualization component (stat cards) uses entity-specific pastel colors.
</objective>

<execution_context>
@/home/yona279/.claude/get-shit-done/workflows/execute-plan.md
@/home/yona279/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-typography-scale-and-color-evolution/18-RESEARCH.md
@.planning/phases/18-typography-scale-and-color-evolution/18-01-SUMMARY.md
@src/components/Layout.tsx
@src/components/Header.tsx
@src/components/ui/StatsCard.tsx
@src/index.css
@tailwind.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update Layout.tsx and Header.tsx for light visual foundation</name>
  <files>src/components/Layout.tsx, src/components/Header.tsx</files>
  <action>
**Layout.tsx changes:**

The `bg-background` utility class is already used throughout Layout.tsx. Since plan 18-01 updates the `--background` CSS var from warm `30 25% 97%` to cool `210 17% 98%`, the background color change propagates automatically. However, verify and clean up:

1. Confirm that `bg-background` is used on both the root div (line 44) and the main content (line 53, 58). These should stay as-is — they consume the updated token automatically.

2. No other className changes needed in Layout.tsx. The layout structure (sidebar offset, header height, content padding) remains correct. The visual transformation comes from the token value change, not from className changes.

**Header.tsx changes:**

The header currently uses `bg-card border-b border-border` (line 102). On the new cooler background:
- `bg-card` renders as `hsl(30 20% 99%)` which is still warm-tinted
- `border-border` renders as `hsl(25 12% 88%)` which is warm-tinted

Update the header to be cleaner on the new light background:

1. Update the header background (line 102):
Replace `bg-card` with `bg-white` — the header should be pure white to create a clean visual separation from the slightly-gray content area background.

2. The `border-b border-border` can stay as-is. The warm border is still harmonious and provides sufficient visual separation. If later testing shows it's too subtle, it can be strengthened in a future phase.

3. The "Desktop - Individual Icons" button for non-admin users (line ~131) uses `bg-primary/10 border border-primary/20 ... hover:bg-primary/15 hover:border-primary/30`. These are fine — primary accent is coral which provides good contrast on white header.

4. The user avatar button (line ~144) uses `bg-primary` which is coral — fine as-is, it's a CTA per COLOR-01 requirement.
  </action>
  <verify>
Read src/components/Layout.tsx and src/components/Header.tsx and confirm:
1. Layout.tsx uses `bg-background` on root div and main content (unchanged, but now consuming cooler value)
2. Header.tsx uses `bg-white` instead of `bg-card` for the header background
3. Header border-b border-border is preserved
4. All other header elements remain unchanged
  </verify>
  <done>Layout shell renders with a cool light gray background; header is pure white with subtle border separation — the overall page feel is light and airy, not warm/dark</done>
</task>

<task type="auto">
  <name>Task 2: Transform StatsCard to use entity color token system</name>
  <files>src/components/ui/StatsCard.tsx</files>
  <action>
Rewrite the color system in `src/components/ui/StatsCard.tsx` to use entity color tokens while maintaining backward compatibility with existing color prop consumers.

**1. Update the color type union in StatsCardProps interface:**
Change:
```typescript
color?: 'blue' | 'green' | 'orange' | 'purple' | 'red' | 'gray' | 'teal' | 'amber'
```
To:
```typescript
color?: 'students' | 'teachers' | 'orchestras' | 'rehearsals' | 'bagrut' | 'theory' | 'blue' | 'green' | 'orange' | 'purple' | 'red' | 'gray' | 'teal' | 'amber'
```
This adds entity colors while keeping the old named colors for backward compatibility.

**2. Add entity color entries to the colorClasses map:**
Add these BEFORE the existing entries in the colorClasses object:
```typescript
// Entity color system (Phase 18)
students: {
  iconBg: 'bg-students-bg',
  iconColor: 'text-students-fg',
  valueColor: 'text-students-fg',
},
teachers: {
  iconBg: 'bg-teachers-bg',
  iconColor: 'text-teachers-fg',
  valueColor: 'text-teachers-fg',
},
orchestras: {
  iconBg: 'bg-orchestras-bg',
  iconColor: 'text-orchestras-fg',
  valueColor: 'text-orchestras-fg',
},
rehearsals: {
  iconBg: 'bg-rehearsals-bg',
  iconColor: 'text-rehearsals-fg',
  valueColor: 'text-rehearsals-fg',
},
bagrut: {
  iconBg: 'bg-bagrut-bg',
  iconColor: 'text-bagrut-fg',
  valueColor: 'text-bagrut-fg',
},
theory: {
  iconBg: 'bg-theory-bg',
  iconColor: 'text-theory-fg',
  valueColor: 'text-theory-fg',
},
```

**3. Add coloredBg prop for full-card pastel background:**
Add to StatsCardProps:
```typescript
coloredBg?: boolean
```

In the component, when `coloredBg` is true, add the entity background color to the Card wrapper. The SchoolHub reference shows stat cards with pastel-tinted card backgrounds (not just icon backgrounds).

Update the return JSX: Instead of `<Card hover>`, use:
```tsx
<Card hover className={coloredBg && color && colorClasses[color] ? colorClasses[color].iconBg : undefined}>
```

Note: This uses the same `iconBg` class (e.g., `bg-students-bg`) on the whole card. The Card component already accepts className — check the Card component's interface to confirm it accepts and merges className. If it uses `cn()` or `clsx()`, the class will merge correctly.

**4. Keep the default color fallback:**
Keep `const colors = colorClasses[color] || colorClasses.blue` — backward compatible, falls back to blue if an unknown color is passed.

**IMPORTANT:** Do NOT change any existing colorClasses entries (blue, green, orange, purple, red, gray, teal, amber). They must remain for backward compatibility — other pages still use them and will be migrated in later phases.
  </action>
  <verify>
Read src/components/ui/StatsCard.tsx and confirm:
1. color prop type includes both entity names and legacy color names
2. colorClasses object has 6 entity entries (students, teachers, orchestras, rehearsals, bagrut, theory)
3. Entity entries use Tailwind entity utilities (bg-students-bg, text-students-fg, etc.)
4. coloredBg prop exists and applies iconBg class to the Card wrapper when true
5. All 8 legacy color entries remain unchanged
6. Default fallback to blue is preserved
  </verify>
  <done>StatsCard accepts entity color names and renders per-entity pastel colors using the CSS var token system; coloredBg prop enables full-card pastel backgrounds; all legacy color values remain supported for backward compatibility</done>
</task>

</tasks>

<verification>
1. Layout.tsx renders with `bg-background` consuming the updated cooler `--background` var
2. Header.tsx uses `bg-white` for pure white header
3. StatsCard accepts `color="students"` and renders violet pastel icon background and text
4. StatsCard accepts `coloredBg` prop for full-card entity-colored backgrounds
5. All legacy StatsCard color values still work (blue, green, orange, etc.)
6. No breaking changes — all existing consumers of these components continue to work
</verification>

<success_criteria>
- Content area background is visibly cooler/lighter than v2.0
- Header is cleanly separated from content via white bg + border
- StatsCard entity colors are available for Dashboard and list page consumption in Phases 19-20
- Zero breaking changes to existing component consumers
- The overall layout feel is light, airy, and fundamentally different from the warm v2.0 palette
</success_criteria>

<output>
After completion, create `.planning/phases/18-typography-scale-and-color-evolution/18-03-SUMMARY.md`
</output>
