---
phase: 08-domain-components-loading-states
plan: 03
type: execute
wave: 2
depends_on: ["08-01"]
files_modified:
  - src/App.tsx
  - tailwind.config.js
  - src/utils/toastUtils.ts
  - src/components/Layout.tsx
autonomous: true

must_haves:
  truths:
    - "Toast notifications appear from the right edge of the screen (physical left = visual right in RTL)"
    - "Toast entrance uses a slide-in animation (not the default top-center drop)"
    - "A success toast shows warm green styling with a checkmark icon"
    - "An error toast shows red styling with an error icon"
    - "Warning and info toast helpers exist and can be called from any component"
    - "Navigating between routes shows a smooth fade-in on the incoming page content"
  artifacts:
    - path: "src/utils/toastUtils.ts"
      provides: "showWarning and showInfo toast helper functions"
      exports: ["showWarning", "showInfo"]
    - path: "tailwind.config.js"
      provides: "slideFromRight and slideToRight keyframes"
      contains: "slideFromRight"
  key_links:
    - from: "src/App.tsx"
      to: "react-hot-toast"
      via: "Toaster position changed to top-left"
      pattern: 'position="top-left"'
    - from: "src/App.tsx"
      to: "tailwind.config.js"
      via: "Toast animation references slideFromRight keyframe"
      pattern: "slideFromRight"
    - from: "src/components/Layout.tsx"
      to: "tailwind.config.js"
      via: "Page content div uses animate-fade-in class"
      pattern: "animate-fade-in"
---

<objective>
Fix toast RTL positioning, add slide-in animation, create warning/info toast helpers, and add page fade-in transition.

Purpose: Satisfy the remaining Phase 8 success criteria — RTL-correct toast positioning (TOAST-01, TOAST-02, TOAST-03, MICRO-03) and smooth page transitions (LOAD-05). Also verify LOAD-06 (ConfirmDeleteDialog consequences) is already satisfied from Phase 7.

Output: Updated Toaster config in App.tsx, new keyframes in tailwind.config.js, toastUtils.ts helpers, and page fade-in in Layout.tsx.
</objective>

<execution_context>
@/home/yona279/.claude/get-shit-done/workflows/execute-plan.md
@/home/yona279/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-domain-components-loading-states/08-RESEARCH.md

Key files to read before implementing:
@src/App.tsx — Toaster config at line 539, position currently "top-center"
@tailwind.config.js — keyframes section at line 196, animation section at line 186
@src/components/Layout.tsx — main element wrapping children at line 52
@src/components/ui/ConfirmDeleteDialog.tsx — check LOAD-06 consequences already present
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix toast RTL position + slide-in animation + warning/info helpers</name>
  <files>
    src/App.tsx
    tailwind.config.js
    src/utils/toastUtils.ts
  </files>
  <action>
**Step 1: Add slideFromRight/slideToRight keyframes to tailwind.config.js**

In the `keyframes` section (after `scaleIn`), add:
```javascript
slideFromRight: {
  '0%': { transform: 'translateX(-100%)', opacity: '0' },
  '100%': { transform: 'translateX(0)', opacity: '1' },
},
slideToRight: {
  '0%': { transform: 'translateX(0)', opacity: '1' },
  '100%': { transform: 'translateX(-100%)', opacity: '0' },
},
```

In the `animation` section, add:
```javascript
'slide-from-right': 'slideFromRight 0.2s ease-out',
'slide-to-right': 'slideToRight 0.15s ease-in forwards',
```

Note: `translateX(-100%)` moves from physical left (= visual right in RTL) inward. This is the correct RTL slide-in direction since `top-left` (physical) = visual right edge in RTL.

**Step 2: Update Toaster config in App.tsx**

Change the Toaster component (around line 539-582):

1. Change `position="top-center"` to `position="top-left"`.
   - Physical `top-left` = visual right edge in RTL.

2. Add a render prop (`children` prop) to the Toaster for custom animation:
```tsx
<Toaster
  position="top-left"
  reverseOrder={false}
  gutter={8}
  containerClassName=""
  containerStyle={{}}
  toastOptions={{
    duration: 4000,
    style: {
      background: '#fff',
      color: '#363636',
      padding: '16px',
      borderRadius: '8px',
      fontSize: '14px',
      fontFamily: 'Heebo, sans-serif',
      direction: 'rtl',
    },
    success: {
      style: {
        background: '#F0FDF4',
        color: '#166534',
        border: '1px solid #86EFAC',
      },
      iconTheme: {
        primary: '#22C55E',
        secondary: '#F0FDF4',
      },
    },
    error: {
      style: {
        background: '#FEE2E2',
        color: '#991B1B',
        border: '1px solid #FCA5A5',
      },
      iconTheme: {
        primary: '#EF4444',
        secondary: '#FEE2E2',
      },
    },
  }}
>
  {(t) => (
    <ToastBar
      toast={t}
      style={{
        ...t.style,
        animation: t.visible
          ? 'slideFromRight 0.2s ease-out'
          : 'slideToRight 0.15s ease-in forwards',
      }}
    />
  )}
</Toaster>
```

3. Add import for `ToastBar` from `react-hot-toast`:
   - Change `import { Toaster } from 'react-hot-toast'` to `import { Toaster, ToastBar } from 'react-hot-toast'`.

4. Update fontFamily from `'Reisinger-Yonatan, sans-serif'` to `'Heebo, sans-serif'` (Phase 6 decision: Heebo is primary UI font).

**Step 3: Create src/utils/toastUtils.ts**

Create a small utilities file for warning and info toast variants (react-hot-toast only has success/error/loading built-in).

```typescript
import toast from 'react-hot-toast'

/**
 * Show a warning toast notification.
 * Uses toast.custom() since react-hot-toast has no built-in warning variant.
 */
export function showWarning(message: string, options?: { duration?: number }) {
  return toast(message, {
    duration: options?.duration ?? 4000,
    icon: '⚠️',
    style: {
      background: '#FFFBEB',
      color: '#92400E',
      border: '1px solid #FCD34D',
      padding: '16px',
      borderRadius: '8px',
      fontSize: '14px',
      fontFamily: 'Heebo, sans-serif',
      direction: 'rtl',
    },
  })
}

/**
 * Show an info toast notification.
 * Uses toast() with custom icon since react-hot-toast has no built-in info variant.
 */
export function showInfo(message: string, options?: { duration?: number }) {
  return toast(message, {
    duration: options?.duration ?? 4000,
    icon: 'ℹ️',
    style: {
      background: '#EFF6FF',
      color: '#1E40AF',
      border: '1px solid #93C5FD',
      padding: '16px',
      borderRadius: '8px',
      fontSize: '14px',
      fontFamily: 'Heebo, sans-serif',
      direction: 'rtl',
    },
  })
}
```

Note: Using `toast()` (blank variant) with custom icon and styling is simpler than `toast.custom()` and still picks up the Toaster animation via the render prop. The `toast.custom()` API bypasses Toaster's children render prop entirely — so using `toast()` with style overrides is the correct approach.
  </action>
  <verify>
1. `grep 'top-left' src/App.tsx` — confirms RTL-correct position
2. `grep 'slideFromRight' tailwind.config.js` — confirms keyframe exists
3. `grep 'ToastBar' src/App.tsx` — confirms render prop used for animation
4. `grep 'showWarning\|showInfo' src/utils/toastUtils.ts` — confirms both helpers exist
5. `grep 'Heebo' src/App.tsx` — confirms font family updated from Reisinger-Yonatan
  </verify>
  <done>
Toaster position is top-left (physical left = visual right in RTL).
Toast entrance uses slideFromRight animation.
Success/error toasts retain warm green/red colors.
showWarning and showInfo helper functions exist in toastUtils.ts.
Font family updated to Heebo.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add page fade-in transition and verify LOAD-06</name>
  <files>
    src/components/Layout.tsx
  </files>
  <action>
**Step 1: Add page fade-in to Layout.tsx**

In `Layout.tsx`, the inner `<div className="p-6 bg-gray-50">` wrapping `{children}` is the page content div. Add `animate-fade-in` to this div:

```tsx
<div className="p-6 bg-gray-50 animate-fade-in">
  {children}
</div>
```

The `animate-fade-in` class uses the existing `fadeIn 0.15s ease-out` keyframe from tailwind.config.js (Phase 6 decision).

**IMPORTANT: Do NOT add `key={pathname}` to any element in Layout.tsx.**
Per research Pitfall 5, adding `key` to the `<main>` element causes layout re-mounts (sidebar/header state resets). The CSS animation approach is simpler and safer:
- Each time React replaces the `{children}` content (route change), the new content DOM node triggers the `animate-fade-in` animation automatically because it's a new element in the DOM.
- If the CSS animation doesn't replay on route change without `key`, the fallback is fine — the transition is subtle at 150ms and the skeleton-to-content swap already provides visual continuity. Do NOT add `key` to force re-renders.

**Step 2: Verify LOAD-06 (ConfirmDeleteDialog consequences)**

Read `src/components/ui/ConfirmDeleteDialog.tsx` and confirm it already has:
- `consequences` prop (string array) with bullet-pointed list
- Text "פעולה זו תגרום גם ל:" header
- Destructive styling on consequences area
- "פעולה זו אינה ניתנת לביטול" warning text

If all present, LOAD-06 is satisfied from Phase 7 — no further action needed. Document this in the summary.

If consequences area is missing or incomplete, add the missing elements. (Based on research, this was already built in Phase 7.)
  </action>
  <verify>
1. `grep 'animate-fade-in' src/components/Layout.tsx` — confirms page transition class present
2. `grep -c 'key=' src/components/Layout.tsx` — should be 0 (no key prop added)
3. `grep 'consequences' src/components/ui/ConfirmDeleteDialog.tsx` — confirms LOAD-06 already satisfied
  </verify>
  <done>
Layout.tsx inner content div has animate-fade-in for smooth page transitions.
No key prop added (avoids layout re-mount pitfall).
LOAD-06 confirmed satisfied by ConfirmDeleteDialog from Phase 7.
  </done>
</task>

</tasks>

<verification>
1. Toast position: `grep 'position="top-left"' src/App.tsx` — present
2. Toast animation: `grep 'slideFromRight' src/App.tsx tailwind.config.js` — present in both
3. Page fade: `grep 'animate-fade-in' src/components/Layout.tsx` — present
4. Warning/info helpers: `grep -c 'export function' src/utils/toastUtils.ts` — 2 functions
5. No key prop on Layout: `grep 'key=' src/components/Layout.tsx` — 0 results
6. LOAD-06: `grep 'consequences' src/components/ui/ConfirmDeleteDialog.tsx` — present
</verification>

<success_criteria>
- Toast slides in from visual right edge (physical left in RTL) with 200ms ease-out animation
- Success toast: warm green background, green checkmark icon
- Error toast: warm red background, red icon
- showWarning(): amber/yellow styling, showInfo(): blue styling — both available via import
- Page route changes show 150ms fade-in on new content
- ConfirmDeleteDialog has consequence list (LOAD-06 satisfied from Phase 7)
</success_criteria>

<output>
After completion, create `.planning/phases/08-domain-components-loading-states/08-03-SUMMARY.md`
</output>
