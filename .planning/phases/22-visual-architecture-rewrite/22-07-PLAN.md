---
phase: 22-visual-architecture-rewrite
plan: 07
type: execute
wave: 2
depends_on: ["22-01"]
files_modified:
  - src/components/bagrut/ProgramTable.tsx
  - src/components/bagrut/ProgramBuilder.tsx
  - src/components/bagrut/PresentationTracker.tsx
  - src/components/bagrut/PresentationForm.tsx
  - src/components/bagrut/OptimizedMagenBagrutForm.tsx
  - src/components/bagrut/MigrationWarningModal.tsx
  - src/components/bagrut/MagenBagrutForm.tsx
  - src/components/bagrut/LazyBagrutTab.tsx
  - src/components/bagrut/GradeSummary.tsx
  - src/components/bagrut/DocumentManager.tsx
  - src/components/bagrut/DirectorEvaluation.tsx
  - src/components/bagrut/ConflictResolutionModal.tsx
  - src/components/bagrut/BagrutExporter.tsx
  - src/components/bagrut/AccompanistManager.tsx
  - src/components/bagrut/BagrutStudentManager.tsx
  - src/components/bagrut/chunks/ProgramBuilderChunk.tsx
  - src/components/bagrut/chunks/PresentationChunk.tsx
  - src/components/bagrut/BagrutHeader.tsx
  - src/components/bagrut/BagrutIntegration.tsx
  - src/components/BagrutCard.tsx
  - src/components/MagenBagrutTab.tsx
  - src/components/DetailedMagenBagrutEditor.tsx
  - src/components/DocumentUpload.tsx
  - src/components/AddPieceModal.tsx
autonomous: true

must_haves:
  truths:
    - "No bg-primary-NNN hardcoded classes remain in bagrut components"
    - "No rounded-xl/2xl/3xl in bagrut components — rounded-full preserved"
    - "Modal components keep Card wrappers (they are floating content)"
  artifacts:
    - path: "src/components/bagrut/ProgramBuilder.tsx"
      provides: "Clean bagrut component with semantic tokens"
    - path: "src/components/BagrutCard.tsx"
      provides: "BagrutCard with semantic tokens"
  key_links:
    - from: "src/components/bagrut/*.tsx"
      to: "src/index.css"
      via: "Semantic token classes"
      pattern: "bg-primary[^-]|bg-muted|border-border"
---

<objective>
Sweep all bagrut-related components (the largest domain module, 24 files) for hardcoded primary-NNN colors and excessive rounding. Bagrut components have heavy primary-NNN usage.

Purpose: The bagrut module is the single largest component group. Without cleaning it, large sections of the app still show old warm coral colors despite the token reset.

Output: 24 bagrut component files cleaned
</objective>

<execution_context>
@/home/yona279/.claude/get-shit-done/workflows/execute-plan.md
@/home/yona279/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/22-visual-architecture-rewrite/22-RESEARCH.md
@.planning/phases/22-visual-architecture-rewrite/22-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Clean bagrut/ directory components</name>
  <files>src/components/bagrut/ProgramTable.tsx, src/components/bagrut/ProgramBuilder.tsx, src/components/bagrut/PresentationTracker.tsx, src/components/bagrut/PresentationForm.tsx, src/components/bagrut/OptimizedMagenBagrutForm.tsx, src/components/bagrut/MigrationWarningModal.tsx, src/components/bagrut/MagenBagrutForm.tsx, src/components/bagrut/LazyBagrutTab.tsx, src/components/bagrut/GradeSummary.tsx, src/components/bagrut/DocumentManager.tsx, src/components/bagrut/DirectorEvaluation.tsx, src/components/bagrut/ConflictResolutionModal.tsx, src/components/bagrut/BagrutExporter.tsx, src/components/bagrut/AccompanistManager.tsx, src/components/bagrut/BagrutStudentManager.tsx, src/components/bagrut/chunks/ProgramBuilderChunk.tsx, src/components/bagrut/chunks/PresentationChunk.tsx, src/components/bagrut/BagrutHeader.tsx, src/components/bagrut/BagrutIntegration.tsx</files>
  <action>
Apply standard replacement rules to all bagrut directory components:

**Color replacements:** Same mapping as Plan 03:
- bg-primary-500/600/700 → bg-primary (buttons) or bg-muted (backgrounds)
- text-primary-500/600/700 → text-primary or text-foreground
- hover:bg-primary-600/700 → hover:bg-neutral-800
- bg-primary-50/100 → bg-muted
- border-primary-NNN → border-border or border-primary

**Rounding replacements:** rounded-xl/2xl/3xl/lg → rounded. Preserve rounded-full on badge/pill elements.

**Modal components (MigrationWarningModal, ConflictResolutionModal):**
- KEEP Card wrapper if used inside dialog — modals are floating content
- Still replace hardcoded color classes with semantic tokens

**Table/grid components (ProgramTable, ProgramBuilder):**
- Tables should be flat: no shadow, no rounded container
- Row hover should be strong: `hover:bg-muted`

Process all 19 files systematically.
  </action>
  <verify>Run `grep -rn "bg-primary-[0-9]\|text-primary-[0-9]\|rounded-xl\|rounded-2xl" src/components/bagrut/` — must return ZERO.</verify>
  <done>All 19 bagrut directory components clean of hardcoded styles.</done>
</task>

<task type="auto">
  <name>Task 2: Clean root-level bagrut-related components</name>
  <files>src/components/BagrutCard.tsx, src/components/MagenBagrutTab.tsx, src/components/DetailedMagenBagrutEditor.tsx, src/components/DocumentUpload.tsx, src/components/AddPieceModal.tsx</files>
  <action>
Apply standard replacement rules to root-level bagrut components:

**Color + rounding replacements:** Same as Task 1.

**BagrutCard.tsx specific:** Has 2 bg-primary-NNN instances. Likely card accent/status colors. Replace with semantic tokens.

**MagenBagrutTab.tsx:** Has 4 bg-primary-NNN instances. Replace all.

**DocumentUpload.tsx:** Has 3 bg-primary-NNN instances. Replace upload button and highlight colors.

**AddPieceModal.tsx:** Has 1 bg-primary-NNN. Modal content — keep Card wrapper if present, replace color.
  </action>
  <verify>Run `grep -rn "bg-primary-[0-9]\|rounded-xl\|rounded-2xl" src/components/BagrutCard.tsx src/components/MagenBagrutTab.tsx src/components/DetailedMagenBagrutEditor.tsx src/components/DocumentUpload.tsx src/components/AddPieceModal.tsx` — must return ZERO.</verify>
  <done>All root-level bagrut components clean. Zero hardcoded primary-NNN or excessive rounding.</done>
</task>

</tasks>

<verification>
1. `grep -rn "bg-primary-[0-9]" src/components/bagrut/ src/components/BagrutCard.tsx src/components/MagenBagrutTab.tsx src/components/DetailedMagenBagrutEditor.tsx` returns zero
2. `grep -rn "rounded-xl\|rounded-2xl" src/components/bagrut/` returns zero
</verification>

<success_criteria>
- Zero hardcoded primary-NNN in all 24 bagrut-related files
- Zero excessive rounding
- Modal Card wrappers preserved
- Tables within bagrut components are flat
</success_criteria>

<output>
After completion, create `.planning/phases/22-visual-architecture-rewrite/22-07-SUMMARY.md`
</output>
