---
phase: 22-visual-architecture-rewrite
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/components/Sidebar.tsx
autonomous: true

must_haves:
  truths:
    - "Phosphor Icons package is installed and importable"
    - "Sidebar renders with deep charcoal background and near-white text"
    - "Active sidebar nav item shows filled Phosphor icon; inactive shows outlined (regular weight)"
    - "No hardcoded gray text/background classes remain in sidebar — all use sidebar token classes"
    - "Sidebar nav links are legible against dark background"
  artifacts:
    - path: "package.json"
      provides: "@phosphor-icons/react dependency"
      contains: "@phosphor-icons/react"
    - path: "src/components/Sidebar.tsx"
      provides: "Dark sidebar with Phosphor icons and token-based colors"
      contains: "@phosphor-icons/react"
  key_links:
    - from: "src/components/Sidebar.tsx"
      to: "src/index.css"
      via: "bg-sidebar, text-sidebar-foreground CSS var tokens"
      pattern: "sidebar-foreground|sidebar-active"
    - from: "src/components/Sidebar.tsx"
      to: "@phosphor-icons/react"
      via: "Icon imports with weight prop"
      pattern: "weight.*fill.*regular"
---

<objective>
Install Phosphor Icons and rewrite the Sidebar component — the most architecturally significant component. The sidebar becomes the dark charcoal anchor with Phosphor filled/outlined icon states.

Purpose: The sidebar is the permanent structural fixture. It must be the first thing that feels different. Dark background, Phosphor icons with fill/regular weight toggle for active/inactive state, all hardcoded gray classes replaced with sidebar token classes.

Output: Installed @phosphor-icons/react, fully rewritten Sidebar.tsx
</objective>

<execution_context>
@/home/yona279/.claude/get-shit-done/workflows/execute-plan.md
@/home/yona279/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ARCHETYPES.md
@.planning/phases/22-visual-architecture-rewrite/22-RESEARCH.md
@src/components/Sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install @phosphor-icons/react and rewrite Sidebar with dark theme + Phosphor icons</name>
  <files>package.json, src/components/Sidebar.tsx</files>
  <action>
**Step 1: Install Phosphor Icons.**

Add `@phosphor-icons/react` to package.json dependencies. Since npm install on the WSL NTFS mount may fail with EIO errors, manually add the dependency to package.json in the `dependencies` section:
```json
"@phosphor-icons/react": "^2.1.7"
```
The user will run `npm install` from Windows PowerShell.

**Step 2: Rewrite Sidebar.tsx icon imports.**

Replace ALL lucide-react imports with Phosphor equivalents. The current sidebar imports from lucide-react:
```
Home, Users, GraduationCap, BookOpen, Music, Calendar, ClipboardList, BarChart3, UserCheck, Settings, Search, Menu, X, Plus, Filter, Award, User, Clock, FileText, UserPlus, CalendarPlus, CheckSquare, Shield, ChevronDown, Building2
```

Replace with Phosphor equivalents (all names end in `Icon`):
```tsx
import {
  HouseIcon, UsersIcon, GraduationCapIcon, BookOpenIcon, MusicNotesIcon,
  CalendarIcon, ClipboardTextIcon, ChartBarIcon, UserCircleCheckIcon,
  GearIcon, MagnifyingGlassIcon, ListIcon, XIcon, PlusIcon, FunnelIcon,
  MedalIcon, UserIcon, ClockIcon, FileTextIcon, UserPlusIcon, CalendarPlusIcon,
  CheckSquareIcon, ShieldIcon, CaretDownIcon, BuildingsIcon
} from '@phosphor-icons/react'
import type { Icon } from '@phosphor-icons/react'
```

**Step 3: Update NavigationItem interface.**

```tsx
interface NavigationItem {
  name: string
  href: string
  Icon: Icon  // Phosphor Icon type
  roles?: string[]
  category?: string
}
```

Update all navigation item definitions to use the new Phosphor icon names (e.g., `icon: Home` becomes `Icon: HouseIcon`, `icon: Users` becomes `Icon: UsersIcon`, etc.).

**Step 4: Rewrite nav link rendering for filled/regular toggle.**

For each nav link, the icon must use `weight="fill"` when active and `weight="regular"` when inactive:

```tsx
<NavLink
  to={item.href}
  className={({ isActive }) =>
    `flex items-center gap-3 px-4 py-2.5 mx-2 rounded text-sm transition-colors ${
      isActive
        ? 'bg-sidebar-active-bg text-sidebar-active-fg font-semibold'
        : 'text-sidebar-foreground/70 hover:bg-sidebar-active-bg/50 hover:text-sidebar-foreground'
    }`
  }
>
  {({ isActive }) => (
    <>
      <item.Icon size={18} weight={isActive ? 'fill' : 'regular'} />
      <span>{item.name}</span>
    </>
  )}
</NavLink>
```

Note: Since NavLink children-as-function provides `isActive`, the icon weight can be dynamic.

**Step 5: Eliminate ALL hardcoded gray classes inside Sidebar.tsx.**

Search for any occurrence of:
- `text-gray-*` → replace with `text-sidebar-foreground` or `text-sidebar-foreground/70`
- `bg-gray-*` → replace with `bg-sidebar-active-bg` or `bg-sidebar-active-bg/50`
- `hover:bg-gray-*` → replace with `hover:bg-sidebar-active-bg/50`
- `border-gray-*` → replace with `border-sidebar-border`
- `bg-white` → replace with `bg-sidebar` (sidebar is now dark, not white)

Also update:
- The sidebar's main container background: must use `bg-sidebar` which now resolves to deep charcoal
- The logo/brand area: ensure text is `text-sidebar-foreground` (near-white)
- Category labels (e.g., "MENU", "OTHER"): use `text-sidebar-label`
- Search input inside sidebar: ensure it works on dark background — use `bg-sidebar-active-bg/30 text-sidebar-foreground placeholder:text-sidebar-foreground/40 border-sidebar-border`
- Toggle/collapse button: update from `bg-gray-100 border-gray-200` to sidebar-appropriate classes
- Any modal triggers or form components that are rendered INSIDE the sidebar should remain functional

**Step 6: RTL icon handling.**

For any directional icons (ChevronLeft used for back navigation, arrows), use the Phosphor `mirrored` prop instead of CSS transforms. Example: `<CaretLeftIcon mirrored size={16} />`. Since the app is RTL-first, `mirrored` ensures correct visual direction.

Keep all existing sidebar functionality intact: collapsible sidebar, mobile menu, quick action modals, role-based navigation filtering, school year selector. Only change icons and styling.
  </action>
  <verify>
1. Grep for `@phosphor-icons/react` in Sidebar.tsx — must find imports
2. Grep for `lucide-react` in Sidebar.tsx — must find ZERO results
3. Grep for `bg-sidebar` in Sidebar.tsx — must find the main container
4. Grep for `text-gray-` in Sidebar.tsx — must find ZERO results (all replaced with token classes)
5. Grep for `weight=` in Sidebar.tsx — must find both "fill" and "regular" patterns
  </verify>
  <done>Sidebar uses Phosphor Icons with fill/regular weight toggle. All hardcoded gray classes replaced with sidebar token classes. Dark charcoal background with legible near-white text. The sidebar is the architectural anchor — tonally distinct from the white content area.</done>
</task>

</tasks>

<verification>
1. No `lucide-react` imports remain in Sidebar.tsx
2. `@phosphor-icons/react` is in package.json dependencies
3. No `text-gray-*` or `bg-gray-*` classes in Sidebar.tsx
4. Active nav items show `weight="fill"`, inactive show `weight="regular"`
5. Sidebar container uses `bg-sidebar` class
</verification>

<success_criteria>
- @phosphor-icons/react is a project dependency
- Sidebar renders with deep charcoal background (via bg-sidebar token)
- Active nav items use filled Phosphor icons, inactive use regular weight
- Zero hardcoded gray classes remain in sidebar
- All sidebar text is legible against dark background
- Existing sidebar functionality preserved (collapse, mobile, modals, role filtering)
</success_criteria>

<output>
After completion, create `.planning/phases/22-visual-architecture-rewrite/22-02-SUMMARY.md`
</output>
