---
phase: 17-primitive-component-layer
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/Card.tsx
  - src/components/ui/button.tsx
  - src/components/ui/badge.tsx
autonomous: true

must_haves:
  truths:
    - "Card components display warm-tinted shadow-1 at rest and deepen to shadow-2 on hover"
    - "Primary action buttons have spring-based press feedback via whileTap using the snappy preset"
    - "Button spring animation is gated by useReducedMotion() — reduced motion users see instant state changes"
    - "Badge default variant has subtle shadow-1 depth"
    - "Button asChild mode continues to work without motion props (Link-as-Button pattern unbroken)"
  artifacts:
    - path: "src/components/ui/Card.tsx"
      provides: "Card with shadow-1 base and hover:shadow-2"
      contains: "shadow-1"
    - path: "src/components/ui/button.tsx"
      provides: "Button with motion.button spring press for non-asChild case"
      contains: "useReducedMotion"
    - path: "src/components/ui/badge.tsx"
      provides: "Badge default variant with shadow-1"
      contains: "shadow-1"
  key_links:
    - from: "src/components/ui/button.tsx"
      to: "src/lib/motionTokens.ts"
      via: "import { snappy }"
      pattern: "import.*snappy.*motionTokens"
    - from: "src/components/ui/button.tsx"
      to: "framer-motion"
      via: "import { motion, useReducedMotion }"
      pattern: "import.*motion.*framer-motion"
---

<objective>
Apply shadow tokens and spring press to Card, Button, and Badge primitives.

Purpose: Cards gain warm-tinted depth (shadow-1/shadow-2), Buttons get spring-based whileTap press feedback gated by reduced motion, and Badge default variant gets subtle shadow-1. These three primitives are imported across 60+ files — every page inherits improvements automatically without callsite changes.

Output: Three updated shadcn/ui component files with token-mapped shadows and Framer Motion spring interactions.
</objective>

<execution_context>
@/home/yona279/.claude/get-shit-done/workflows/execute-plan.md
@/home/yona279/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-token-foundation/16-02-SUMMARY.md
@.planning/phases/17-primitive-component-layer/17-RESEARCH.md
@src/components/ui/Card.tsx
@src/components/ui/button.tsx
@src/components/ui/badge.tsx
@src/lib/motionTokens.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Card shadow token swap and Button spring press</name>
  <files>src/components/ui/Card.tsx, src/components/ui/button.tsx</files>
  <action>
**Card.tsx changes (pure CSS, no Framer Motion):**

1. Replace `shadow-sm` with `shadow-1` in the Card base className (line 16).
2. Move `transition-shadow` from the hover conditional to the base className so it always applies (smooth transitions even when hover prop is absent but className overrides add hover).
3. Add `duration-200` alongside `transition-shadow` for consistent timing.
4. Replace `hover:shadow-md` with `hover:shadow-2` inside the hover conditional (line 17).
5. The hover conditional should now just be `hover && "hover:shadow-2"` (transition-shadow is on base).

Result:
```
"rounded-lg border bg-card text-card-foreground shadow-1 transition-shadow duration-200",
hover && "hover:shadow-2",
```

**button.tsx changes (Framer Motion spring press):**

1. Add imports at top:
   - `import { motion, useReducedMotion } from "framer-motion"`
   - `import { snappy } from "@/lib/motionTokens"`

2. Inside the `Button` forwardRef, before the `Comp` assignment:
   - Add `const shouldReduceMotion = useReducedMotion() ?? false`

3. Add a branch: when `asChild` is false, render `motion.button` instead of `"button"`:
   ```tsx
   if (!asChild) {
     return (
       <motion.button
         ref={ref}
         className={cn(buttonVariants({ variant, size, className }))}
         whileTap={shouldReduceMotion ? undefined : { scale: 0.95 }}
         transition={snappy}
         {...(props as React.ComponentProps<"button">)}
       />
     )
   }
   ```

4. When `asChild` is true, keep the existing `Slot` render path unchanged (no motion props on Slot).

5. Keep the existing `active:scale-95` CSS class in the buttonVariants base string. It is additive with whileTap and provides instant feedback for reduced-motion users. Do NOT remove it.

6. The existing `transition-colors` in the CVA base is for background color transitions and does NOT conflict with Framer Motion's scale animation (different CSS property).

**TypeScript note:** The spread `{...(props as React.ComponentProps<"button">)}` avoids TS errors from motion-specific props not being in ButtonProps. Do not use `as any`.
  </action>
  <verify>
Run: `grep -n "shadow-1" src/components/ui/Card.tsx` — should show shadow-1 in base class.
Run: `grep -n "shadow-2" src/components/ui/Card.tsx` — should show hover:shadow-2 in hover conditional.
Run: `grep -n "useReducedMotion" src/components/ui/button.tsx` — should show the import and usage.
Run: `grep -n "motion.button" src/components/ui/button.tsx` — should show the motion.button element.
Run: `grep -n "snappy" src/components/ui/button.tsx` — should show import and transition prop.
Run: `grep -n "active:scale-95" src/components/ui/button.tsx` — should still be present (NOT removed).
  </verify>
  <done>
Card renders shadow-1 at rest and shadow-2 on hover. Button renders motion.button with whileTap spring press (scale 0.95 via snappy preset) for non-asChild case, gated by useReducedMotion(). asChild path renders Slot without motion props. active:scale-95 CSS class is preserved.
  </done>
</task>

<task type="auto">
  <name>Task 2: Badge default variant shadow token</name>
  <files>src/components/ui/badge.tsx</files>
  <action>
Add `shadow-1` to the `default` variant in badgeVariants to give default badges subtle warm-tinted depth.

1. In the `default` variant string (line 12), add `shadow-1` after the existing classes:
   - Before: `"border-transparent bg-primary text-primary-foreground hover:bg-primary/80"`
   - After: `"border-transparent bg-primary text-primary-foreground shadow-1 hover:bg-primary/80"`

2. Do NOT modify any domain status variants (active, inactive, graduated, pending, completed). These are color-coded for entity status and adding shadows would clutter them.

3. Do NOT modify secondary, destructive, outline, or success variants — these don't need elevation.

This is a light-touch change. If it looks visually cluttered in the app, the shadow can be removed later. The default variant is used for primary emphasis badges.
  </action>
  <verify>
Run: `grep -n "shadow-1" src/components/ui/badge.tsx` — should show shadow-1 in default variant line only.
Run: `grep "shadow" src/components/ui/badge.tsx | wc -l` — should be exactly 1 occurrence (only default variant).
  </verify>
  <done>
Badge default variant has shadow-1 for subtle warm depth. No domain status variants are modified. No other variants are modified.
  </done>
</task>

</tasks>

<verification>
1. `grep -rn "shadow-1" src/components/ui/Card.tsx src/components/ui/badge.tsx` — both files contain shadow-1
2. `grep -rn "shadow-2" src/components/ui/Card.tsx` — hover uses shadow-2
3. `grep -rn "useReducedMotion" src/components/ui/button.tsx` — reduced motion guard present
4. `grep -rn "motion.button" src/components/ui/button.tsx` — Framer motion button element present
5. `grep -rn "snappy" src/components/ui/button.tsx` — spring preset imported and used
6. `grep -rn "active:scale-95" src/components/ui/button.tsx` — CSS fallback preserved
7. `grep -rn "asChild.*Slot" src/components/ui/button.tsx` — Slot path still exists for Link-as-Button
</verification>

<success_criteria>
- Card.tsx: shadow-sm replaced with shadow-1; hover:shadow-md replaced with hover:shadow-2; transition-shadow on base class
- button.tsx: motion.button renders for non-asChild case with whileTap={{ scale: 0.95 }} gated by useReducedMotion(), transition=snappy; Slot path unchanged for asChild
- badge.tsx: default variant includes shadow-1; all other variants unchanged
- No new dependencies installed (framer-motion already in package.json)
- No new z-index values added
</success_criteria>

<output>
After completion, create `.planning/phases/17-primitive-component-layer/17-01-SUMMARY.md`
</output>
