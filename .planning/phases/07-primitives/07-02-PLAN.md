---
phase: 07-primitives
plan: 02
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - src/features/teachers/details/components/TeacherDetailsPage.tsx
  - src/features/teachers/details/components/TeacherTabNavigation.tsx
  - src/features/teachers/details/components/TeacherTabContent.tsx
  - src/features/students/details/components/StudentDetailsPage.tsx
  - src/features/students/details/components/StudentDetailsPageSimple.tsx
  - src/features/students/details/components/StudentDetailsPageOptimized.tsx
  - src/features/students/details/components/StudentTabNavigation.tsx
  - src/features/students/details/components/StudentTabContent.tsx
  - src/features/orchestras/details/components/OrchestraDetailsPage.tsx
  - src/features/orchestras/details/components/OrchestraTabNavigation.tsx
  - src/features/orchestras/details/components/OrchestraTabContent.tsx
  - src/pages/Orchestras.tsx
  - src/components/ui/ConfirmationModal.tsx
  - src/styles/tab-navigation-fix.css
  - src/styles/teacher-modal-fixes.css
autonomous: true

must_haves:
  truths:
    - "Teacher detail page tabs use shadcn Tabs with icons and correct RTL tab ordering"
    - "Student detail page tabs use shadcn Tabs with icons, handling 8 tabs with overflow-x-auto on mobile"
    - "Orchestra detail page tabs use shadcn Tabs"
    - "Orchestras page delete action uses ConfirmDeleteDialog instead of ConfirmDeleteModal"
    - "ConfirmationModal wraps shadcn Dialog instead of custom Modal"
    - "TODO(Phase 7) !important blocks removed from tab-navigation-fix.css and teacher-modal-fixes.css"
    - "Tab navigation is keyboard-accessible (arrow keys move between tabs, per Radix Tabs ARIA pattern)"
  artifacts:
    - path: "src/features/teachers/details/components/TeacherDetailsPage.tsx"
      provides: "Teacher detail page with shadcn Tabs"
      contains: "TabsList"
    - path: "src/features/students/details/components/StudentDetailsPage.tsx"
      provides: "Student detail page with shadcn Tabs"
      contains: "TabsList"
    - path: "src/features/orchestras/details/components/OrchestraDetailsPage.tsx"
      provides: "Orchestra detail page with shadcn Tabs"
      contains: "TabsList"
    - path: "src/pages/Orchestras.tsx"
      provides: "Orchestra list with ConfirmDeleteDialog"
      contains: "ConfirmDeleteDialog"
    - path: "src/styles/tab-navigation-fix.css"
      provides: "Cleaned CSS without !important display toggles"
  key_links:
    - from: "src/features/teachers/details/components/TeacherDetailsPage.tsx"
      to: "src/components/ui/tabs.tsx"
      via: "import Tabs, TabsList, TabsTrigger, TabsContent"
      pattern: "from.*@/components/ui/tabs"
    - from: "src/pages/Orchestras.tsx"
      to: "src/components/ui/ConfirmDeleteDialog.tsx"
      via: "import ConfirmDeleteDialog"
      pattern: "import.*ConfirmDeleteDialog"
    - from: "src/components/ui/ConfirmationModal.tsx"
      to: "src/components/ui/dialog.tsx"
      via: "import Dialog components (replaces Modal import)"
      pattern: "from.*dialog"
---

<objective>
Migrate all 3 detail page tab navigations from custom split-component pattern to shadcn Tabs, migrate Orchestras delete modal to ConfirmDeleteDialog, update ConfirmationModal to wrap shadcn Dialog, and clean up dead CSS (remove TODO(Phase 7) !important blocks, delete dead tab CSS classes).

Purpose: Complete the migration from custom UI primitives to shadcn/ui, resolving all Phase 7 TODO items from Phase 6 CSS cleanup.
Output: 3 detail pages with shadcn Tabs, 1 page with ConfirmDeleteDialog, 1 updated ConfirmationModal, cleaned CSS files.
</objective>

<execution_context>
@/home/yona279/.claude/get-shit-done/workflows/execute-plan.md
@/home/yona279/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-primitives/07-RESEARCH.md
@.planning/phases/07-primitives/07-01-SUMMARY.md

Source files to read before editing:
@src/features/teachers/details/components/TeacherDetailsPage.tsx
@src/features/teachers/details/components/TeacherTabNavigation.tsx
@src/features/teachers/details/components/TeacherTabContent.tsx
@src/features/teachers/details/types/index.ts
@src/features/students/details/components/StudentDetailsPage.tsx
@src/features/students/details/components/StudentDetailsPageSimple.tsx
@src/features/students/details/components/StudentDetailsPageOptimized.tsx
@src/features/students/details/components/StudentTabNavigation.tsx
@src/features/students/details/components/StudentTabContent.tsx
@src/features/students/details/types/index.ts
@src/features/orchestras/details/components/OrchestraDetailsPage.tsx
@src/features/orchestras/details/components/OrchestraTabNavigation.tsx
@src/features/orchestras/details/components/OrchestraTabContent.tsx
@src/features/orchestras/details/types/index.ts
@src/pages/Orchestras.tsx
@src/components/ui/ConfirmationModal.tsx
@src/styles/tab-navigation-fix.css
@src/styles/teacher-modal-fixes.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate all 3 detail page tab navigations to shadcn Tabs</name>
  <files>
    src/features/teachers/details/components/TeacherDetailsPage.tsx
    src/features/teachers/details/components/TeacherTabNavigation.tsx
    src/features/teachers/details/components/TeacherTabContent.tsx
    src/features/students/details/components/StudentDetailsPage.tsx
    src/features/students/details/components/StudentDetailsPageSimple.tsx
    src/features/students/details/components/StudentDetailsPageOptimized.tsx
    src/features/students/details/components/StudentTabNavigation.tsx
    src/features/students/details/components/StudentTabContent.tsx
    src/features/orchestras/details/components/OrchestraDetailsPage.tsx
    src/features/orchestras/details/components/OrchestraTabNavigation.tsx
    src/features/orchestras/details/components/OrchestraTabContent.tsx
    src/styles/tab-navigation-fix.css
  </files>
  <action>
    **Migration pattern (same for all 3 detail pages):**

    Each detail page currently uses a split pattern: `XxxTabNavigation` renders buttons, `XxxTabContent` renders a switch statement. Replace with unified shadcn `Tabs` in the detail page itself.

    **A. Teacher Details Page Migration**

    In `TeacherDetailsPage.tsx`:
    1. Remove imports of `TeacherTabNavigation` and `TeacherTabContent`
    2. Add imports: `{ Tabs, TabsList, TabsTrigger, TabsContent }` from `@/components/ui/tabs`
    3. Add imports for tab content components directly: `PersonalInfoTab`, `StudentManagementTab`, `ScheduleTab`, `ConductingTab`, `HoursSummaryTab` from `./tabs/*`
    4. Add imports for icons: `{ User, Users, Calendar, Music, Clock }` from `lucide-react`
    5. Replace the `<TeacherTabNavigation ... />` + `<TeacherTabContent ... />` block with:

    ```tsx
    <Tabs value={activeTab} onValueChange={(v) => setActiveTab(v as TeacherTabType)} className="w-full">
      <TabsList className="sticky top-0 z-10 w-full justify-start rounded-none border-b bg-white h-auto px-6 overflow-x-auto">
        <TabsTrigger value="personal" className="gap-2 inline-flex items-center">
          <User className="h-4 w-4" />
          מידע אישי
        </TabsTrigger>
        <TabsTrigger value="students" className="gap-2 inline-flex items-center">
          <Users className="h-4 w-4" />
          ניהול תלמידים
        </TabsTrigger>
        <TabsTrigger value="schedule" className="gap-2 inline-flex items-center">
          <Calendar className="h-4 w-4" />
          לוח זמנים
        </TabsTrigger>
        {/* Conducting tab: only render if teacher conducts */}
        {showConductingTab && (
          <TabsTrigger value="conducting" className="gap-2 inline-flex items-center">
            <Music className="h-4 w-4" />
            ניצוח
          </TabsTrigger>
        )}
        <TabsTrigger value="hours" className="gap-2 inline-flex items-center">
          <Clock className="h-4 w-4" />
          שעות שבועיות
        </TabsTrigger>
      </TabsList>

      <TabsContent value="personal" className="mt-0">
        <PersonalInfoTab teacher={teacher} teacherId={teacherId} />
      </TabsContent>
      <TabsContent value="students" className="mt-0">
        <StudentManagementTab teacher={teacher} teacherId={teacherId} />
      </TabsContent>
      <TabsContent value="schedule" className="mt-0">
        <ScheduleTab teacher={teacher} teacherId={teacherId} />
      </TabsContent>
      {showConductingTab && (
        <TabsContent value="conducting" className="mt-0">
          <ConductingTab teacher={teacher} teacherId={teacherId} />
        </TabsContent>
      )}
      <TabsContent value="hours" className="mt-0">
        <HoursSummaryTab teacher={teacher} teacherId={teacherId} />
      </TabsContent>
    </Tabs>
    ```

    Where `showConductingTab` is derived from:
    ```tsx
    const showConductingTab = teacher?.conducting?.orchestraIds?.length > 0 ||
      (teacher as any)?.conducting?.ensemblesIds?.length > 0 ||
      teacher?.ensemblesIds?.length > 0 ||
      teacher?.roles?.includes('מנצח')
    ```

    Keep `isLoading` handling: wrap the Tabs in a condition — if `isLoading || !teacher`, show the existing skeleton placeholder (from TeacherTabContent's loading state).

    **B. Student Details Page Migration**

    Same pattern for `StudentDetailsPage.tsx` (and `StudentDetailsPageSimple.tsx`, `StudentDetailsPageOptimized.tsx`):
    1. Remove imports of `StudentTabNavigation` and `StudentTabContent`
    2. Add imports for `Tabs, TabsList, TabsTrigger, TabsContent` from `@/components/ui/tabs`
    3. Import tab content components and icons directly
    4. Student has 8 tabs with icons: personal (User), academic (GraduationCap), schedule (Calendar), attendance (CheckCircle), orchestra (Music), theory (BookOpen), bagrut (Award), documents (FileText)
    5. Apply `overflow-x-auto scrollbar-hide` to TabsList for mobile horizontal scrolling (8 tabs won't fit on small screens)
    6. Use controlled mode: `value={activeTab}` + `onValueChange`

    **Important for Student pages:** There are 3 variants (StudentDetailsPage, StudentDetailsPageSimple, StudentDetailsPageOptimized). All 3 use the same TabNavigation/TabContent split. Migrate all 3 consistently. Read each file's specific tab content imports and props before editing.

    **C. Orchestra Details Page Migration**

    Same pattern for `OrchestraDetailsPage.tsx`:
    1. Remove imports of `OrchestraTabNavigation` and `OrchestraTabContent`
    2. Orchestra tabs are simpler (3 tabs, no icons in current implementation)
    3. Read `OrchestraTabContent.tsx` to identify the tab values and content components
    4. Apply same Tabs pattern with controlled mode

    **D. Clean up tab-navigation-fix.css**

    After all 3 tab navigations are migrated:
    1. Remove the `TODO(Phase 7)` comment and the entire `@media (max-width: 768px)` block that has `!important` display toggles for `.desktop-tab-nav` and `.mobile-tab-nav`
    2. Remove the `@media (min-width: 769px)` block with the same `!important` toggles
    3. Remove the CSS rules for `.desktop-tab-nav`, `.mobile-tab-nav`, `.student-tab-navigation`, and `.tab-button` classes — these are now dead code since shadcn Tabs handles its own styling
    4. Keep the general rules: `.student-details-container`, `.student-content-area`, `.layout-main`, `.calendar-container-wrapper`, `body, html { overflow-x: hidden }`, and `#root` rules — these are layout constraints still used by the page containers

    **E. TeacherTabNavigation.tsx and StudentTabNavigation.tsx become dead files**

    After migration, `TeacherTabNavigation.tsx`, `TeacherTabContent.tsx`, `StudentTabNavigation.tsx`, `StudentTabContent.tsx`, `OrchestraTabNavigation.tsx`, `OrchestraTabContent.tsx` are no longer imported by their detail pages. However, they may still be exported from index.ts barrel files. Check:
    - `src/features/students/details/index.ts` — remove re-exports of dead components
    - `src/features/orchestras/details/components/index.ts` — remove re-exports
    - Do NOT delete the files yet — leave them as dead code for now; they can be cleaned up in a future pass. Just remove the imports and re-exports so they are truly unused.

    **F. Handle the teacher-student-select native `<select>` in StudentManagementTab**

    Read `src/features/teachers/details/components/tabs/StudentManagementTab.tsx` and find the `<select>` elements with class `teacher-student-select`. These are native `<select>` dropdowns for day-of-week and duration.

    These native selects are NOT the primary focus of this task (they are simple form controls, not the modal/tab migration). However, note that after tab migration, the teacher-modal-fixes.css `TODO(Phase 7)` for native `<option>` styling remains a separate concern. For now: leave the native selects as-is but remove the `TODO(Phase 7)` comment in `teacher-modal-fixes.css` and add a `TODO(Phase 9)` comment instead, since the form system redesign in Phase 9 is the natural place to replace native form controls with shadcn equivalents.

    **Important notes:**
    - Keep all tab content component logic unchanged — only the navigation/rendering wrapper changes
    - Use controlled Tabs (`value`/`onValueChange`) to preserve the existing `activeTab` state management
    - Apply `mt-0` to all TabsContent to remove the default margin-top that shadcn Tabs adds
    - The `className="sticky top-0 z-10"` on TabsList preserves the existing sticky header behavior
  </action>
  <verify>
    1. `grep "TabsList" src/features/teachers/details/components/TeacherDetailsPage.tsx` — Teacher uses shadcn Tabs
    2. `grep "TabsList" src/features/students/details/components/StudentDetailsPage.tsx` — Student uses shadcn Tabs
    3. `grep "TabsList" src/features/orchestras/details/components/OrchestraDetailsPage.tsx` — Orchestra uses shadcn Tabs
    4. `grep -c "!important" src/styles/tab-navigation-fix.css` — 0 (all !important removed)
    5. `grep -c "desktop-tab-nav\|mobile-tab-nav\|\.tab-button" src/styles/tab-navigation-fix.css` — 0 (dead classes removed)
    6. `grep -v "^//" src/features/teachers/details/components/TeacherDetailsPage.tsx | grep -c "TeacherTabNavigation\|TeacherTabContent"` — 0 (old imports removed)
    7. `npm run build` passes without errors
  </verify>
  <done>
    All 3 detail page tab navigations use shadcn Tabs with icons, controlled state, sticky headers, and RTL-correct keyboard navigation. Dead CSS classes (.desktop-tab-nav, .mobile-tab-nav, .tab-button, .student-tab-navigation) removed from tab-navigation-fix.css. !important display toggles removed. Dead component re-exports removed from barrel files. Build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate Orchestras delete modal + update ConfirmationModal to use Dialog</name>
  <files>
    src/pages/Orchestras.tsx
    src/components/ui/ConfirmationModal.tsx
  </files>
  <action>
    **A. Migrate Orchestras.tsx from ConfirmDeleteModal to ConfirmDeleteDialog**

    In `src/pages/Orchestras.tsx`:
    1. Replace `import ConfirmDeleteModal from '../components/ui/ConfirmDeleteModal'` with `import ConfirmDeleteDialog from '../components/ui/ConfirmDeleteDialog'`
    2. Find the `<ConfirmDeleteModal ... />` usage and replace with `<ConfirmDeleteDialog ... />`
    3. Map props:
       - `isOpen={showDeleteConfirm}` → `open={showDeleteConfirm}`
       - `onCancel={() => setShowDeleteConfirm(false)}` → `onOpenChange={setShowDeleteConfirm}`
       - `onConfirm={handleDeleteOrchestra}` → `onConfirm={handleDeleteOrchestra}`
       - `title`, `message`, `itemName` → same prop names
       - `isLoading` → same
    4. If the component used `confirmText`/`cancelText`, pass them through (ConfirmDeleteDialog supports these)

    **B. Rewrite ConfirmationModal to wrap shadcn Dialog**

    The current `ConfirmationModal` imports and wraps `Modal`. Since `Modal` is now a Dialog wrapper (from 07-01), ConfirmationModal transitively uses Dialog. However, the current implementation manually renders header/content/footer inside Modal's children. Update it to use Dialog subcomponents directly for better accessibility:

    1. Replace `import Modal from './Modal'` with direct Dialog imports: `import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog'`
    2. Import `{ Button } from '@/components/ui/button'`
    3. Preserve the existing prop interface: `isOpen`, `title`, `message`, `confirmText`, `cancelText`, `onConfirm`, `onCancel`, `variant`
    4. Map variant to Button variant: danger → `variant="destructive"`, warning → `variant="default"` with yellow styling, info → `variant="default"` with blue styling
    5. Keep the `AlertTriangle` icon with variant-based coloring
    6. Use `Dialog open={isOpen} onOpenChange={(open) => !open && onCancel()}`
    7. Use `DialogContent className="max-w-md duration-200"`
    8. Use `DialogHeader` with `DialogTitle` containing the icon + title
    9. Use `DialogDescription` for the message
    10. Use `DialogFooter` with `Button variant="outline"` for cancel and variant-appropriate Button for confirm
    11. The early `if (!isOpen) return null` can be removed since Dialog handles visibility

    **Important:** ConfirmationModal is used by 6+ files. The prop interface MUST stay identical — this is a transparent implementation swap. Do not change any prop names or add new required props.
  </action>
  <verify>
    1. `grep "ConfirmDeleteDialog" src/pages/Orchestras.tsx` — uses new dialog
    2. `grep -v "ConfirmDeleteModal" src/pages/Orchestras.tsx | wc -l` — no references to old modal remain
    3. `grep "DialogContent" src/components/ui/ConfirmationModal.tsx` — wraps Dialog directly
    4. `grep -v "import Modal" src/components/ui/ConfirmationModal.tsx | wc -l` — Modal import removed
    5. `npm run build` passes
  </verify>
  <done>
    Orchestras.tsx uses ConfirmDeleteDialog with Hebrew text, destructive button, and proper Dialog accessibility. ConfirmationModal transparently wraps shadcn Dialog while preserving its existing prop interface (isOpen/onCancel/onConfirm/title/message/variant) — all 6+ callsites work without changes. Build passes.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` — full project builds without errors
2. All 3 detail pages (Teacher, Student, Orchestra) use shadcn Tabs (grep for TabsList)
3. Orchestras.tsx uses ConfirmDeleteDialog (not ConfirmDeleteModal)
4. ConfirmationModal wraps shadcn Dialog (not custom Modal)
5. tab-navigation-fix.css has zero !important declarations
6. teacher-modal-fixes.css TODO(Phase 7) comment updated to TODO(Phase 9)
7. Dead CSS classes (.desktop-tab-nav, .mobile-tab-nav, .tab-button) removed
8. No TypeScript import errors for removed components
</verification>

<success_criteria>
- Clicking through Teacher/Student/Orchestra tabs uses shadcn Tabs with correct RTL ordering
- Tab keyboard navigation works (arrow keys per Radix ARIA Tabs pattern)
- Teacher and Student tabs show icons alongside Hebrew labels
- Student tabs handle 8-tab overflow with horizontal scrolling on mobile
- Orchestras delete action opens ConfirmDeleteDialog with Hebrew text and destructive button
- ConfirmationModal's 6+ callsites work unchanged (transparent Dialog swap)
- All TODO(Phase 7) items from Phase 6 CSS cleanup are resolved
- Zero build errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-primitives/07-02-SUMMARY.md`
</output>
