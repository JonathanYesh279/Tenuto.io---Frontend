---
phase: 22-visual-architecture-rewrite
plan: 11
type: execute
wave: 3
depends_on: ["22-02", "22-04", "22-08"]
files_modified:
  - src/components/domain/DetailPageHeader.tsx
  - src/features/teachers/details/components/TeacherDetailsPage.tsx
  - src/features/teachers/details/components/TeacherTabNavigation.tsx
  - src/features/students/details/components/StudentDetailsPage.tsx
  - src/features/students/details/components/StudentDetailsHeader.tsx
  - src/features/students/details/components/StudentTabNavigation.tsx
  - src/features/orchestras/details/components/OrchestraDetailsPage.tsx
autonomous: true

must_haves:
  truths:
    - "Detail page header is a structured identity block — not a pastel card, not a gradient banner"
    - "Tab bar is attached INSIDE the identity block — no gap between header and tabs"
    - "Entity accent is a thin left border or subtle text color — not a full pastel background"
    - "Tab content feels like a continuous document — not stacked cards"
    - "Identity block uses display-scale typography for entity name"
  artifacts:
    - path: "src/components/domain/DetailPageHeader.tsx"
      provides: "Dossier-style identity block with attached tab bar zone"
    - path: "src/features/teachers/details/components/TeacherDetailsPage.tsx"
      provides: "Teacher detail using dossier archetype"
  key_links:
    - from: "src/features/teachers/details/components/TeacherDetailsPage.tsx"
      to: "src/components/domain/DetailPageHeader.tsx"
      via: "DetailPageHeader renders identity block"
      pattern: "DetailPageHeader"
    - from: "src/components/domain/DetailPageHeader.tsx"
      to: "src/features/teachers/details/components/TeacherTabNavigation.tsx"
      via: "Tab navigation rendered inside identity block container"
      pattern: "TabNavigation|children"
---

<objective>
Implement the Detail Page (Dossier) archetype on all three entity detail pages. Rewrite DetailPageHeader as a structured identity block with tonal shift, attach the tab bar inside it, and create a continuous document feel.

Purpose: Detail pages are where users spend the most time with individual entity data. The current pastel card header + floating tab bar + stacked card sections pattern is the most "template-like" structure. This plan replaces it with a professional dossier layout.

Output: DetailPageHeader rewritten, three entity detail pages restructured
</objective>

<execution_context>
@/home/yona279/.claude/get-shit-done/workflows/execute-plan.md
@/home/yona279/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ARCHETYPES.md
@.planning/phases/22-visual-architecture-rewrite/22-RESEARCH.md
@.planning/phases/22-visual-architecture-rewrite/22-04-SUMMARY.md
@.planning/phases/22-visual-architecture-rewrite/22-08-SUMMARY.md
@src/components/domain/DetailPageHeader.tsx
@src/features/teachers/details/components/TeacherDetailsPage.tsx
@src/features/teachers/details/components/TeacherTabNavigation.tsx
@src/features/students/details/components/StudentDetailsPage.tsx
@src/features/students/details/components/StudentTabNavigation.tsx
@src/features/orchestras/details/components/OrchestraDetailsPage.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite DetailPageHeader as identity block with tab attachment zone</name>
  <files>src/components/domain/DetailPageHeader.tsx</files>
  <action>
Rewrite DetailPageHeader to implement the Dossier archetype identity block:

**New structure:**
```tsx
<div className="bg-muted/40 border-b border-border">
  {/* Breadcrumb — minimal, above identity */}
  <div className="px-6 pt-4 pb-0">
    <button onClick={() => navigate(breadcrumbHref)} className="flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors">
      <CaretRightIcon size={14} weight="bold" mirrored />
      {breadcrumbLabel}
    </button>
  </div>

  {/* Identity block — name at display scale, avatar with entity accent */}
  <div className="px-6 pt-4 pb-4 flex items-center gap-4">
    <AvatarInitials
      {...}
      className="h-14 w-14 rounded-full text-lg"
      style={{ borderLeft: `3px solid hsl(var(--color-${entityColor}-fg))` }}
    />
    <div className="flex-1">
      <h1 className="text-2xl font-bold text-foreground">{displayName}</h1>
      <div className="flex items-center gap-2 mt-1.5">
        {badges}
        {updatedAt && (
          <span className="text-xs text-muted-foreground">
            עודכן: {formatLastUpdated(updatedAt)}
          </span>
        )}
      </div>
    </div>
  </div>

  {/* Tab bar attachment zone — children rendered HERE, inside the header block */}
  {children && (
    <div className="px-6">
      {children}
    </div>
  )}
</div>
```

**Key changes from current:**
1. `bg-muted/40` replaces vivid entity-colored `bg-teachers-bg` etc. — subtle tonal shift, not pastel
2. Entity accent is a thin left border on the avatar, not a full background
3. `children` prop renders INSIDE the container, below identity but before the `border-b` — this is the tab attachment zone
4. Breadcrumb uses Phosphor `CaretRightIcon` with `mirrored` for RTL
5. Typography: `text-2xl font-bold` for name (display scale)
6. No Card wrapper, no shadow, no rounded-xl

**Import changes:**
```tsx
import { CaretRightIcon } from '@phosphor-icons/react'
```
Replace the lucide `ChevronLeft` import.

Keep all existing props. The `entityColor` prop is still used for the thin accent border on the avatar. The `ENTITY_DETAIL_STYLES` lookup can be simplified — only need `fg` color for accent, not full bg/nameFg/etc.
  </action>
  <verify>
1. Grep for `lucide-react` in DetailPageHeader.tsx — ZERO results
2. Grep for `bg-teachers-bg\|bg-students-bg` in DetailPageHeader.tsx — ZERO results (no vivid pastel)
3. Grep for `CaretRightIcon` in DetailPageHeader.tsx — confirms Phosphor icon
4. Grep for `bg-muted/40` in DetailPageHeader.tsx — confirms tonal shift approach
  </verify>
  <done>DetailPageHeader is a structured identity block with tonal shift, entity accent border, display-scale typography, and tab attachment zone via children prop.</done>
</task>

<task type="auto">
  <name>Task 2: Wire tab bars into identity blocks on all three detail pages</name>
  <files>src/features/teachers/details/components/TeacherDetailsPage.tsx, src/features/teachers/details/components/TeacherTabNavigation.tsx, src/features/students/details/components/StudentDetailsPage.tsx, src/features/students/details/components/StudentDetailsHeader.tsx, src/features/students/details/components/StudentTabNavigation.tsx, src/features/orchestras/details/components/OrchestraDetailsPage.tsx</files>
  <action>
On each detail page, move the tab navigation INSIDE the DetailPageHeader as a child:

**Before (typical pattern):**
```tsx
<DetailPageHeader ... />
<div className="mt-4">  {/* GAP */}
  <TeacherTabNavigation ... />
</div>
<div className="p-6">
  {tabContent}
</div>
```

**After:**
```tsx
<DetailPageHeader ...>
  <TeacherTabNavigation ... />
</DetailPageHeader>
{/* NO gap — content starts immediately */}
<div className="px-6 py-6">
  {tabContent}
</div>
```

The tab navigation is now passed as `children` to DetailPageHeader and renders inside the tonal `bg-muted/40` block, attached to the identity. The `border-b border-border` on the header creates the visual line separating header from content.

**Tab navigation styling update:**
In TeacherTabNavigation.tsx, StudentTabNavigation.tsx, and any orchestra tab nav:
- Tabs should be simple text links with a bottom border indicator, not pills
- Active tab: `text-foreground font-semibold border-b-2 border-foreground`
- Inactive tab: `text-muted-foreground hover:text-foreground`
- Tab container: `flex gap-6` — clean, no background, inline with identity block

Replace any remaining lucide-react imports in tab navigation components with Phosphor equivalents.

**Tab content area:**
- Remove any Card wrappers from tab content sections on all three detail pages
- Tab content should feel like a continuous document: `<div className="px-6 py-6">` with section headings + spacing, not Card-wrapped panels

**StudentDetailsHeader.tsx:** If this is a separate header component, update it with the same identity block pattern as DetailPageHeader, or consolidate to use DetailPageHeader directly.

Preserve all existing tab logic, data fetching, and content rendering. Only change structural layout and styling.
  </action>
  <verify>
1. In TeacherDetailsPage.tsx, the tab navigation is rendered inside DetailPageHeader children — grep for the pattern
2. No vertical gap between header and tab bar
3. Tab content has no Card wrapper
4. Grep for `lucide-react` in TeacherTabNavigation.tsx, StudentTabNavigation.tsx — should be ZERO
  </verify>
  <done>All three entity detail pages have identity block with attached tab bar. Tab content is a continuous document feel. No pastel card headers. No floating tab bars. Dossier archetype achieved.</done>
</task>

</tasks>

<verification>
1. DetailPageHeader renders tonal bg-muted/40 block, not vivid entity pastel
2. Tab navigation is inside the header block on all three detail pages
3. No Card wrappers in tab content areas
4. Phosphor icons used for breadcrumb navigation
5. Entity accent is thin border, not background fill
</verification>

<success_criteria>
- Detail page header is a structured identity block with bg-muted/40 tonal shift
- Entity accent expressed as thin left border on avatar, not full pastel background
- Tab bar attached inside identity block — no vertical gap
- Tab content is continuous document — no Card-wrapped sections
- Display-scale typography on entity name
- Phosphor CaretRightIcon for breadcrumb
- All three entity detail pages follow this pattern
</success_criteria>

<output>
After completion, create `.planning/phases/22-visual-architecture-rewrite/22-11-SUMMARY.md`
</output>
