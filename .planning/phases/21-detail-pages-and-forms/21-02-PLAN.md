---
phase: 21-detail-pages-and-forms
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/TeacherForm.tsx
  - src/components/StudentForm.tsx
  - src/components/OrchestraForm.tsx
autonomous: true

must_haves:
  truths:
    - "Each form has clearly labeled visual sections with accent markers separating groups of fields — not flat stacked fields"
    - "Form visual rhythm follows section title -> field group -> section title -> field group pattern"
    - "Section accent bars use entity color (teachers-fg, students-fg, orchestras-fg) for visual identity consistency with detail page headers"
    - "OrchestraForm section headers remain compact (py-2 not py-6) to fit within modal max-h-[90vh] constraint"
  artifacts:
    - path: "src/components/TeacherForm.tsx"
      provides: "Teacher form with visual section grouping using accent bars"
      contains: "bg-teachers-fg"
    - path: "src/components/StudentForm.tsx"
      provides: "Student form with visual section grouping using accent bars"
      contains: "bg-students-fg"
    - path: "src/components/OrchestraForm.tsx"
      provides: "Orchestra form with visual section grouping using accent bars"
      contains: "bg-orchestras-fg"
  key_links:
    - from: "src/components/TeacherForm.tsx"
      to: "entity color tokens"
      via: "static Tailwind classes"
      pattern: "bg-teachers-fg"
    - from: "src/components/StudentForm.tsx"
      to: "entity color tokens"
      via: "static Tailwind classes"
      pattern: "bg-students-fg"
    - from: "src/components/OrchestraForm.tsx"
      to: "entity color tokens"
      via: "static Tailwind classes"
      pattern: "bg-orchestras-fg"
---

<objective>
Restructure the three entity forms (TeacherForm, StudentForm, OrchestraForm) with visual section grouping — each section gets an entity-colored accent bar and clear heading, replacing the current flat `<section>` + `<h3>` pattern with intentional visual rhythm.

Purpose: Forms should read as structured documents with clear section boundaries, matching the visual confidence of the redesigned dashboard and list pages. The pattern "section title with accent marker -> field group -> section title -> field group" creates visual rhythm that guides the user through multi-section forms.

Output: All 3 form files restructured with section accent bars and visual grouping. NO changes to state management, validation, handlers, or business logic — JSX structure only.
</objective>

<execution_context>
@/home/yona279/.claude/get-shit-done/workflows/execute-plan.md
@/home/yona279/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/21-detail-pages-and-forms/21-RESEARCH.md
@src/components/TeacherForm.tsx
@src/components/StudentForm.tsx
@src/components/OrchestraForm.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Restructure TeacherForm and StudentForm with visual sections</name>
  <files>
    src/components/TeacherForm.tsx
    src/components/StudentForm.tsx
  </files>
  <action>
**CRITICAL: JSX restructure ONLY. Do NOT change state management, handleInputChange, handleSubmit, validation, useEffect, or any handler functions.** Only modify the JSX return section to wrap existing sections with visual section headers.

**Section Header Pattern (accent bar approach — RTL-safe):**
Replace each plain `<section>` + `<h3 className="text-lg font-semibold text-gray-900 mb-4">` with:

```tsx
<div className="mb-8">
  <div className="flex items-center gap-3 mb-4">
    <div className="w-1 h-6 bg-{entity}-fg rounded-full" />
    <h3 className="text-base font-semibold text-foreground">{section title}</h3>
  </div>
  {/* existing field grid and inputs — UNCHANGED */}
</div>
```

Note: The accent bar uses a static `<div>` with `w-1 h-6` dimensions. In RTL layout, flex items render right-to-left, so the accent bar (first DOM child) appears on the right (visual start in Hebrew) — this is correct with no extra RTL overrides needed.

**TeacherForm sections (6 sections, entity color: `bg-teachers-fg`):**

1. **מידע אישי** (Personal Info) — lines ~276-408: Replace `<section>` + `<h3>` wrapper. Keep the `<div className="grid grid-cols-1 md:grid-cols-2 gap-6">` and all inputs unchanged.

2. **תפקידים** (Roles) — lines ~410-432: Replace `<section>` + `<h3>` wrapper. Keep checkbox grid unchanged.

3. **מידע מקצועי** (Professional Info) — lines ~434-538: Replace `<section>` + `<h3>` wrapper. Keep the grid and all dropdowns/inputs unchanged.

4. **מקצועות הוראה** (Teaching Subjects) — lines ~540-562: Replace `<section>` + `<h3>` wrapper. Keep checkbox grid unchanged.

5. **פרטי התחברות** (Login Credentials) — lines ~563-612: Replace `<section>` + `<h3>` wrapper. Keep input fields unchanged.

6. **סטטוס** (Status) — lines ~613-end: Replace `<section>` + `<h3>` wrapper. Keep toggle unchanged.

Also update the form title h2 area:
- Change `className="text-2xl font-bold text-gray-900"` to `className="text-2xl font-bold text-foreground"` (use semantic token, not gray-900).

**StudentForm sections (4 sections, entity color: `bg-students-fg`):**

1. **פרטים אישיים** (Personal Details) — around line 393: Replace `<h3>` wrapper with accent bar pattern.

2. **פרטים אקדמיים** (Academic Details) — around line 574: Replace `<h3>` wrapper with accent bar pattern.

3. **הרשמות והשתייכויות** (Enrollments) — around line 905: Replace `<h3>` wrapper with accent bar pattern.

4. **סטטוס** (Status) — around line 943: Replace `<h3>` wrapper with accent bar pattern.

Also update the form title h2: change `text-gray-900` to `text-foreground`.

**Spacing:** Use `mb-8` on each section wrapper div (not `mb-6`) to create clear breathing room between sections. The form already uses `space-y-8` on the outer form element, so this aligns.
  </action>
  <verify>
Run `grep -c "bg-teachers-fg rounded-full" src/components/TeacherForm.tsx` — should return 6 (one accent bar per section).
Run `grep -c "bg-students-fg rounded-full" src/components/StudentForm.tsx` — should return 4 (one accent bar per section).
Run `grep "text-lg font-semibold text-gray-900" src/components/TeacherForm.tsx` — should return ZERO matches (old pattern replaced).
Run `grep "text-lg font-semibold text-gray-900" src/components/StudentForm.tsx` — should return ZERO matches.
Verify no changes to handleInputChange, handleSubmit, setFormData, or useState in either file.
  </verify>
  <done>
TeacherForm has 6 visually grouped sections with teachers-fg accent bars. StudentForm has 4 visually grouped sections with students-fg accent bars. Both forms follow section-title->field-group visual rhythm. No state management or logic changes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Restructure OrchestraForm with compact visual sections</name>
  <files>src/components/OrchestraForm.tsx</files>
  <action>
**CRITICAL: JSX restructure ONLY. Do NOT change handleInputChange, handleSubmit, useState, useEffect, or validation logic.**

**Context:** OrchestraForm renders inside a modal with `max-h-[90vh] overflow-y-auto`. Section headers must be compact (py-2 not py-6) to avoid pushing the form content and save button below the visible modal area. See Research pitfall #5.

**OrchestraForm currently has a flat layout** without `<section>` tags — fields are in `<div className="grid ...">` blocks with inline comments as section markers. Add visual section grouping around existing field groups:

**Section Header Pattern (compact for modal — entity color: `bg-orchestras-fg`):**
```tsx
<div className="mb-6">
  <div className="flex items-center gap-2 mb-3">
    <div className="w-1 h-5 bg-orchestras-fg rounded-full" />
    <h3 className="text-sm font-semibold text-foreground">{section title}</h3>
  </div>
  {/* existing field grid — UNCHANGED */}
</div>
```

Note: Compared to TeacherForm/StudentForm, this pattern uses:
- `mb-6` instead of `mb-8` (tighter spacing for modal)
- `gap-2` instead of `gap-3` (tighter)
- `h-5` instead of `h-6` (shorter accent bar)
- `text-sm` instead of `text-base` (smaller heading to save vertical space)
- `mb-3` instead of `mb-4` (tighter gap below heading)

**Sections to create (3 sections):**

1. **פרטי הרכב** (Ensemble Details) — wrap the first grid (lines ~155-234: name, type, location fields). This is the `<div className="grid grid-cols-1 md:grid-cols-2 gap-6">` block.

2. **פרטי משרד** (Ministry & Classification) — wrap the second grid (lines ~237-297: subType, performanceLevel, coordinationHours) plus the conductor assignment field (lines ~300-328). This is the `<div className="grid grid-cols-1 md:grid-cols-3 gap-6">` block and the FormField for conductorId.

3. **חברים וסטטוס** (Members & Status) — wrap the members display (lines ~331-353) and the isActive checkbox (lines ~356-368).

**Do NOT wrap** the form header (h2 + X button), error display, or form action buttons (submit/cancel) in section groups — those are structural chrome, not data sections.
  </action>
  <verify>
Run `grep -c "bg-orchestras-fg rounded-full" src/components/OrchestraForm.tsx` — should return 3 (one accent bar per section).
Run `grep "h-5 bg-orchestras-fg" src/components/OrchestraForm.tsx` — should match (compact h-5, not h-6).
Run `grep "text-sm font-semibold" src/components/OrchestraForm.tsx` — should match section headings (compact text-sm, not text-base).
Verify no changes to handleInputChange, handleSubmit, setFormData, or useState.
  </verify>
  <done>
OrchestraForm has 3 compact visually grouped sections with orchestras-fg accent bars. Section headers are compact (text-sm, h-5, mb-6) to respect the modal max-h-[90vh] constraint. No state management or logic changes.
  </done>
</task>

</tasks>

<verification>
1. `grep -c "rounded-full" src/components/TeacherForm.tsx` includes 6 accent bar divs
2. `grep -c "rounded-full" src/components/StudentForm.tsx` includes 4 accent bar divs
3. `grep -c "rounded-full" src/components/OrchestraForm.tsx` includes 3 accent bar divs
4. `grep "text-lg font-semibold text-gray-900" src/components/TeacherForm.tsx src/components/StudentForm.tsx` returns ZERO matches (old pattern fully replaced)
5. Entity color accent bars use correct entity token: teachers-fg, students-fg, orchestras-fg respectively
6. No string interpolation (`bg-${`) in any modified file
7. OrchestraForm accent bars use compact sizing (h-5, text-sm) vs standard sizing (h-6, text-base)
</verification>

<success_criteria>
- All 3 forms have visual section grouping with entity-colored accent bars
- Section titles are clearly separated from field groups with consistent spacing
- Visual rhythm follows "section heading with accent marker -> field grid -> section heading -> field grid" pattern
- TeacherForm: 6 sections with bg-teachers-fg accent
- StudentForm: 4 sections with bg-students-fg accent
- OrchestraForm: 3 compact sections with bg-orchestras-fg accent (modal-appropriate sizing)
- ZERO changes to state management, validation, or business logic in any form
- Forms look intentionally sectioned, not flat stacked
</success_criteria>

<output>
After completion, create `.planning/phases/21-detail-pages-and-forms/21-02-SUMMARY.md`
</output>
