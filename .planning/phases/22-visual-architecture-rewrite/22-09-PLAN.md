---
phase: 22-visual-architecture-rewrite
plan: 09
type: execute
wave: 2
depends_on: ["22-01"]
files_modified:
  - src/components/deletion/StudentDeletionModal.tsx
  - src/components/deletion/OrphanedReferenceCleanup.tsx
  - src/components/deletion/OptimizedCascadeDeletionDemo.tsx
  - src/components/deletion/EnhancedProgressTracker.tsx
  - src/components/deletion/DeletionUIDemo.tsx
  - src/components/deletion/DeletionTimeline.tsx
  - src/components/deletion/DeletionProgressTracker.tsx
  - src/components/deletion/DeletionImpactPreview.tsx
  - src/components/deletion/DataIntegrityDashboard.tsx
  - src/components/deletion/CascadeDeletionWorkflow.tsx
  - src/components/deletion/AuditLogViewer.tsx
  - src/components/deletion/AdminDeletionDashboard.tsx
  - src/components/DeletionImpactModal.tsx
  - src/components/BatchDeletionModal.tsx
  - src/components/SafeDeleteModal.tsx
  - src/components/ConflictDetector.tsx
  - src/components/VirtualizedStudentList.tsx
  - src/components/AttendanceManager.tsx
  - src/components/enrollment/OrchestraEnrollmentManager.tsx
  - src/components/OrchestraMemberManagement.tsx
  - src/components/OrchestraManagementDashboard.tsx
  - src/components/OrchestraDetailsModal.tsx
  - src/components/OrchestraCard.tsx
  - src/components/StudentCard.tsx
  - src/components/TeacherCard.tsx
  - src/components/InstrumentProgress.tsx
  - src/components/LessonSlot.tsx
  - src/components/TheoryLessonCard.tsx
  - src/components/RehearsalCard.tsx
  - src/components/RehearsalCalendar.tsx
  - src/components/PerformanceCard.tsx
  - src/components/PresentationCard.tsx
  - src/components/PresentationDetailsModal.tsx
  - src/components/PerformanceDetailsModal.tsx
  - src/components/AdditionalRehearsalsModal.tsx
  - src/components/StudentDetailsTest.tsx
  - src/components/TeacherNameDisplay.tsx
autonomous: true

must_haves:
  truths:
    - "No bg-primary-NNN hardcoded classes remain in remaining components"
    - "No rounded-xl/2xl/3xl in remaining components — rounded-full preserved"
    - "Modal/dialog components keep Card wrappers"
  artifacts:
    - path: "src/components/deletion/StudentDeletionModal.tsx"
      provides: "Modal with semantic tokens, Card wrapper preserved"
    - path: "src/components/StudentCard.tsx"
      provides: "Entity card with semantic tokens"
  key_links:
    - from: "src/components/*.tsx"
      to: "src/index.css"
      via: "Semantic token classes"
      pattern: "bg-primary[^-]|bg-muted|border-border"
---

<objective>
Sweep all remaining components — deletion module (12 files), entity cards, modals, schedule components, miscellaneous — for hardcoded primary-NNN colors and excessive rounding. This is the final bulk cleanup plan.

Purpose: After Plans 03-08, the pages, forms, dashboard, bagrut, and feature detail components are clean. This plan catches everything else — deletion module, entity cards, standalone modals, and miscellaneous components. After this plan, the ENTIRE codebase uses semantic tokens.

Output: 37 remaining component files cleaned
</objective>

<execution_context>
@/home/yona279/.claude/get-shit-done/workflows/execute-plan.md
@/home/yona279/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/22-visual-architecture-rewrite/22-RESEARCH.md
@.planning/phases/22-visual-architecture-rewrite/22-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Clean deletion module and modal components</name>
  <files>src/components/deletion/StudentDeletionModal.tsx, src/components/deletion/OrphanedReferenceCleanup.tsx, src/components/deletion/OptimizedCascadeDeletionDemo.tsx, src/components/deletion/EnhancedProgressTracker.tsx, src/components/deletion/DeletionUIDemo.tsx, src/components/deletion/DeletionTimeline.tsx, src/components/deletion/DeletionProgressTracker.tsx, src/components/deletion/DeletionImpactPreview.tsx, src/components/deletion/DataIntegrityDashboard.tsx, src/components/deletion/CascadeDeletionWorkflow.tsx, src/components/deletion/AuditLogViewer.tsx, src/components/deletion/AdminDeletionDashboard.tsx, src/components/DeletionImpactModal.tsx, src/components/BatchDeletionModal.tsx, src/components/SafeDeleteModal.tsx, src/components/PresentationDetailsModal.tsx, src/components/PerformanceDetailsModal.tsx, src/components/AdditionalRehearsalsModal.tsx, src/components/OrchestraDetailsModal.tsx</files>
  <action>
Apply standard replacement rules to all deletion and modal components:

**Color:** bg-primary-NNN → semantic tokens. Same mapping as Plan 03.
**Rounding:** rounded-xl/2xl/3xl/lg → rounded. Preserve rounded-full.

**ALL modal components in this list:** KEEP Card wrappers — these are floating/overlay content that correctly uses Card.

**Deletion module specifics:**
- Destructive action buttons should use `bg-destructive text-destructive-foreground` (not primary)
- Progress indicators may use primary-NNN for progress bars — replace with `bg-primary` (black) or an appropriate indicator color
- Timeline/log components: replace decorative primary-NNN with `border-border` or `bg-muted`
  </action>
  <verify>Run `grep -rn "bg-primary-[0-9]\|text-primary-[0-9]\|rounded-xl\|rounded-2xl" src/components/deletion/ src/components/DeletionImpactModal.tsx src/components/BatchDeletionModal.tsx src/components/SafeDeleteModal.tsx` — must return ZERO.</verify>
  <done>All deletion and modal components clean of hardcoded styles. Card wrappers preserved in modals.</done>
</task>

<task type="auto">
  <name>Task 2: Clean entity cards, schedule, and remaining misc components</name>
  <files>src/components/ConflictDetector.tsx, src/components/VirtualizedStudentList.tsx, src/components/AttendanceManager.tsx, src/components/enrollment/OrchestraEnrollmentManager.tsx, src/components/OrchestraMemberManagement.tsx, src/components/OrchestraManagementDashboard.tsx, src/components/OrchestraCard.tsx, src/components/StudentCard.tsx, src/components/TeacherCard.tsx, src/components/InstrumentProgress.tsx, src/components/LessonSlot.tsx, src/components/TheoryLessonCard.tsx, src/components/RehearsalCard.tsx, src/components/RehearsalCalendar.tsx, src/components/PerformanceCard.tsx, src/components/PresentationCard.tsx, src/components/StudentDetailsTest.tsx, src/components/TeacherNameDisplay.tsx</files>
  <action>
Apply standard replacement rules:

**Color:** bg-primary-NNN → semantic tokens. Same mapping.
**Rounding:** rounded-xl/2xl/3xl/lg → rounded. Preserve rounded-full on avatars.

**Entity cards (StudentCard, TeacherCard, OrchestraCard):**
- Replace vivid entity-colored backgrounds with subdued entity-bg tokens
- Cards in list view are data items — they should be flat with subtle entity accent (thin border or small badge), not full pastel backgrounds
- If these cards use Card component for their wrapper, consider if they appear in a list (remove Card wrapper, use simple div with border-bottom) or standalone (may keep Card)

**Schedule/calendar components:**
- LessonSlot, RehearsalCalendar — replace primary-NNN with semantic tokens
- Calendar time slots may use color coding — ensure it uses entity color tokens, not primary-NNN
  </action>
  <verify>Run `grep -rn "bg-primary-[0-9]\|text-primary-[0-9]\|rounded-xl\|rounded-2xl" src/components/StudentCard.tsx src/components/TeacherCard.tsx src/components/OrchestraCard.tsx src/components/AttendanceManager.tsx src/components/InstrumentProgress.tsx` — must return ZERO.</verify>
  <done>All remaining components clean. The ENTIRE src/components directory is free of hardcoded primary-NNN colors and excessive rounding.</done>
</task>

</tasks>

<verification>
After Plans 03-09 complete, run the final comprehensive check:
1. `grep -rn "bg-primary-[0-9]" src/` — must return ZERO results (excluding backup files, node_modules)
2. `grep -rn "text-primary-[0-9]" src/` — must return ZERO results
3. `grep -rn "rounded-xl\|rounded-2xl\|rounded-3xl" src/` — must return ZERO results (excluding rounded-full)
</verification>

<success_criteria>
- Zero hardcoded primary-NNN across the ENTIRE src/ directory
- Zero excessive rounding across the ENTIRE src/ directory
- rounded-full preserved on all avatar/pill elements
- Modal Card wrappers preserved
- The complete codebase uses the semantic token system
</success_criteria>

<output>
After completion, create `.planning/phases/22-visual-architecture-rewrite/22-09-SUMMARY.md`
</output>
